"use strict";(self.webpackChunkvuepress_theme_hope_template=self.webpackChunkvuepress_theme_hope_template||[]).push([[537],{81021:(s,i)=>{i.A=(s,i)=>{const a=s.__vccOpts||s;for(const[s,e]of i)a[s]=e;return a}},66993:(s,i,a)=>{a.r(i),a.d(i,{comp:()=>r,data:()=>p});var e=a(6254);const t=a.p+"assets/img/image-20241014190222-ohiryzp.40da1324.png",n=a.p+"assets/img/image-20241014104513-4s7czkp.711e6f1e.png",l=a.p+"assets/img/image-20241014104635-k1jy291.d450b48b.png",h={},r=(0,a(81021).A)(h,[["render",function(s,i){return(0,e.uX)(),(0,e.CE)("div",null,i[0]||(i[0]=[(0,e.Fv)('<h4 id="用户管理" tabindex="-1"><a class="header-anchor" href="#用户管理"><span>用户管理</span></a></h4><h5 id="特权用户排查" tabindex="-1"><a class="header-anchor" href="#特权用户排查"><span>特权用户排查</span></a></h5><p>UID=0为特权账号</p><div class="language-bat line-numbers-mode" data-highlighter="shiki" data-ext="bat" data-title="bat" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@localhost ~]# awk -F: &#39;($3</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">0)&#39; /etc/passwd</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">root:x:0:0:root:/root:/bin/bash</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@localhost ~]# passwd -l XXXXX</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">^</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">C\t#锁定账户,建议如果存在多个UID为0用户,先锁定再去排查,最后在确定是否删除或解除</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@localhost ~]# userdel XXXXX</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">^</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">C\t#删除</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@localhost ~]# passwd -u XXXXX</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">^</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">\t#解除锁定</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="空口令用户排查" tabindex="-1"><a class="header-anchor" href="#空口令用户排查"><span>空口令用户排查</span></a></h5><div class="language-bat line-numbers-mode" data-highlighter="shiki" data-ext="bat" data-title="bat" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@localhost ~]# awk -F: &#39;($2</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)&#39; /etc/shadow</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@localhost ~]# passwd username\t\t#增加密码</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="限制用户su到root" tabindex="-1"><a class="header-anchor" href="#限制用户su到root"><span>限制用户su到root</span></a></h5><p>/etc/pam.d/su su命令的配置文件:如下配置1\\test组和test用户可以su到root</p><p>​<img src="'+t+'" alt="image" loading="lazy">​</p><h5 id="禁止root用户直接登录" tabindex="-1"><a class="header-anchor" href="#禁止root用户直接登录"><span>禁止root用户直接登录</span></a></h5><p>（危险配置，如果远程新建小号登录，要不然远程ssh直接掉线）</p><p>/etc/ssh/sshd_config | grep PermitRootLogin</p><div class="language-apache line-numbers-mode" data-highlighter="shiki" data-ext="apache" data-title="apache" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@localhost ~]# cat /etc/ssh/sshd_config |grep PermitRootLogin</span></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#PermitRootLogin yes\t\t\t#讲此项放出,并改为No.则会警用root远程登录</span></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># the setting of &quot;PermitRootLogin without-password&quot;.</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#重启生效</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">systemctl restart sshd\t\t\t#service sshd restart</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​<img src="'+n+'" alt="image" loading="lazy">​</p><h4 id="服务管理" tabindex="-1"><a class="header-anchor" href="#服务管理"><span>服务管理</span></a></h4><h5 id="关闭不必要自启服务" tabindex="-1"><a class="header-anchor" href="#关闭不必要自启服务"><span>关闭不必要自启服务</span></a></h5><p>netstart -ntlp</p><p>​<img src="'+l+'" alt="image" loading="lazy">​</p><p>systemctl disable &lt;服务名称&gt; 设置服务不开机自启</p><div class="language-apache line-numbers-mode" data-highlighter="shiki" data-ext="apache" data-title="apache" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">systemctl disable &lt;服务名称&gt;\t#设置服务不开启自启动</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">centos6等老系统禁用方法不一样:chkconfig --level &lt;级别&gt; &lt;服务名称&gt;  off #设置服务在某个级别用户开机时不启动</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="ssh服务配置" tabindex="-1"><a class="header-anchor" href="#ssh服务配置"><span>ssh服务配置</span></a></h5><p>vi /etc/ssh/sshd_config</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Protocol  </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  #修改SSH使用的协议版本 2  1.0 2.0</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">MaxAuthTries  </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">6</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  #密码错误次数锁定</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>重启生效<br> systemctl restart sshd #service sshd restart</p><p>‍</p><h4 id="系统日志" tabindex="-1"><a class="header-anchor" href="#系统日志"><span>系统日志</span></a></h4><p>系统日志： /var/log/messages</p><p>cron日志： /var/log/cron</p><p>安全日志： /var/log/securce</p><p>查看是否开启日志记录： cat /etc/logrotate.d/syslog</p><div class="language-apache line-numbers-mode" data-highlighter="shiki" data-ext="apache" data-title="apache" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/var/log/cron</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/var/log/maillog</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/var/log/messages</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/var/log/secure</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/var/log/spooler</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    missingok</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    sharedscripts</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    postrotate</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">\t/bin/kill -HUP `cat /var/run/syslogd.pid </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; /dev/null` </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; /dev/null || true</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    endscript</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>‍</p><p>‍</p>',33)]))}]]),p=JSON.parse('{"path":"/response/Linux%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA.html","title":"Linux安全加固","lang":"zh-CN","frontmatter":{"title":"Linux安全加固","index":true,"isOriginal":true,"date":"2024-10-14T00:00:00.000Z","category":["应急响应"],"tag":["Linux安全加固","安全加固","应急响应"],"description":"用户管理 特权用户排查 UID=0为特权账号 空口令用户排查 限制用户su到root /etc/pam.d/su su命令的配置文件:如下配置1\\\\test组和test用户可以su到root ​image​ 禁止root用户直接登录 （危险配置，如果远程新建小号登录，要不然远程ssh直接掉线） /etc/ssh/sshd_config | grep Pe...","head":[["meta",{"property":"og:url","content":"https://mister-hope.github.io/blog/response/Linux%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA.html"}],["meta",{"property":"og:site_name","content":"卷卷"}],["meta",{"property":"og:title","content":"Linux安全加固"}],["meta",{"property":"og:description","content":"用户管理 特权用户排查 UID=0为特权账号 空口令用户排查 限制用户su到root /etc/pam.d/su su命令的配置文件:如下配置1\\\\test组和test用户可以su到root ​image​ 禁止root用户直接登录 （危险配置，如果远程新建小号登录，要不然远程ssh直接掉线） /etc/ssh/sshd_config | grep Pe..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-01-12T13:43:01.000Z"}],["meta",{"property":"article:tag","content":"Linux安全加固"}],["meta",{"property":"article:tag","content":"安全加固"}],["meta",{"property":"article:tag","content":"应急响应"}],["meta",{"property":"article:published_time","content":"2024-10-14T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-01-12T13:43:01.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Linux安全加固\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2024-10-14T00:00:00.000Z\\",\\"dateModified\\":\\"2025-01-12T13:43:01.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"卷卷\\"}]}"]]},"headers":[],"git":{"createdTime":1736689381000,"updatedTime":1736689381000,"contributors":[{"name":"youze","username":"youze","email":"youze27@163.com","commits":1,"url":"https://github.com/youze"}]},"readingTime":{"minutes":1.46,"words":439},"filePathRelative":"response/Linux安全加固.md","localizedDate":"2024年10月14日","excerpt":"<h4>用户管理</h4>\\n<h5>特权用户排查</h5>\\n<p>UID=0为特权账号</p>\\n<div class=\\"language-bat line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"bat\\" data-title=\\"bat\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code><span class=\\"line\\"><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">[root@localhost ~]# awk -F: \'($3</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">==</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">0)\' /etc/passwd</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">root:x:0:0:root:/root:/bin/bash</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">[root@localhost ~]# passwd -l XXXXX</span><span style=\\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\\">^</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">C\\t#锁定账户,建议如果存在多个UID为0用户,先锁定再去排查,最后在确定是否删除或解除</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">[root@localhost ~]# userdel XXXXX</span><span style=\\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\\">^</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">C\\t#删除</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">[root@localhost ~]# passwd -u XXXXX</span><span style=\\"--shiki-light:#0184BC;--shiki-dark:#56B6C2\\">^</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">\\t#解除锁定</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","autoDesc":true}')}}]);